Script started on 2023-07-26 15:34:39+02:00
[0;35m[DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. See https://docs.ansible.com/ansible-[0m
[0;35mcore/2.14/user_guide/playbooks_reuse_includes.html for details. This feature will be removed in version 2.16. Deprecation warnings can be disabled by setting [0m
[0;35mdeprecation_warnings=False in ansible.cfg.[0m

PLAY [all] *********************************************************************************************************************************************************

TASK [Gathering Facts] *********************************************************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : include] **************************************************************************************************************************************
[0;35m[DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks/import_playbook instead. This feature will be removed in version 2.16. Deprecation [0m
[0;35mwarnings can be disabled by setting deprecation_warnings=False in ansible.cfg.[0m
[0;36mincluded: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/CIS-RedHat-8.yml for dcex1601tto0b1c[0m

TASK [cis_security : include] **************************************************************************************************************************************
[0;36mincluded: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/redhat-8-type.yml for dcex1601tto0b1c[0m

TASK [cis_security : Print Header] *********************************************************************************************************************************
[0;32mok: [dcex1601tto0b1c] => {[0m
[0;32m    "msg": "CIS Controls for RedHat 8"[0m
[0;32m}[0m

TASK [cis_security : Collect package list] *************************************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.1.1.1 Ensure mounting of cramfs filesystems is disabled] ************************************************************************************
[0;31m--- before: /etc/modprobe.d/cramfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/cramfs.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install cramfs /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1601tto0b1c] => (item={'From': '(?m)^\\S+\\s+install cramfs', 'To': 'install cramfs /bin/true'})[0m
[0;31m--- before: /etc/modprobe.d/cramfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/cramfs.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+blacklist cramfs[0m
[0;32m[0m
[0;33mchanged: [dcex1601tto0b1c] => (item={'From': '(?m)^\\S+\\s+blacklist cramfs', 'To': 'blacklist cramfs'})[0m

TASK [cis_security : 1.1.1.1 Ensure mounting of cramfs filesystems is disabled | modprobe] *************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.1.1.3 Ensure mounting of squashfs filesystems is disabled] **********************************************************************************
[0;31m--- before: /etc/modprobe.d/squashfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/squashfs.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install squashfs /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1601tto0b1c] => (item={'From': '(?m)^\\S+\\s+install squashfs', 'To': 'install squashfs /bin/true'})[0m
[0;31m--- before: /etc/modprobe.d/squashfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/squashfs.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+blacklist squashfs[0m
[0;32m[0m
[0;33mchanged: [dcex1601tto0b1c] => (item={'From': '(?m)^\\S+\\s+blacklist squashfs', 'To': 'blacklist squashfs'})[0m

TASK [cis_security : 1.1.1.3 Ensure mounting of cramfs filesystems is disabled | modprobe] *************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.1.1.4 Ensure mounting of udf filesystems is disabled] ***************************************************************************************
[0;31m--- before: /etc/modprobe.d/udf.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/udf.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install udf /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1601tto0b1c] => (item={'From': '(?m)^\\S+\\s+install udf', 'To': 'install udf /bin/true'})[0m
[0;31m--- before: /etc/modprobe.d/udf.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/udf.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+blacklist udf[0m
[0;32m[0m
[0;33mchanged: [dcex1601tto0b1c] => (item={'From': '(?m)^\\S+\\s+blacklist udf', 'To': 'blacklist udf'})[0m

TASK [cis_security : 1.1.1.4 Ensure mounting of udf filesystems is disabled | modprobe] ****************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : Ensure the local-fs directory is created] *****************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,10 +1,4 @@[0m
[0;36m[0m {
     "path": "/etc/systemd/system/local-fs.target.wants",
[0;31m-    "path_content": {[0m
[0;31m[0m[0;31m-        "directories": [],[0m
[0;31m[0m[0;31m-        "files": [[0m
[0;31m[0m[0;31m-            "/etc/systemd/system/local-fs.target.wants/readonly-root.service"[0m
[0;31m[0m[0;31m-        ][0m
[0;31m[0m[0;31m-    },[0m
[0;31m[0m[0;31m-    "state": "directory"[0m
[0;31m[0m[0;32m+    "state": "absent"[0m
[0;32m[0m }

[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : 1.1.[2-5] - Configure config file for tmpfs] **************************************************************************************************
[0;31m--- before: /etc/systemd/system/local-fs.target.wants/tmp.mount (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/system/local-fs.target.wants/tmp.mount (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1,7 @@[0m
[0;36m[0m[0;32m+# BEGIN ANSIBLE MANAGED BLOCK[0m
[0;32m[0m[0;32m+[Mount][0m
[0;32m[0m[0;32m+What=tmpfs[0m
[0;32m[0m[0;32m+Where=/tmp[0m
[0;32m[0m[0;32m+Type=tmpfs[0m
[0;32m[0m[0;32m+Options=mode=1777,strictatime,noexec,nodev,nosuid[0m
[0;32m[0m[0;32m+# END ANSIBLE MANAGED BLOCK[0m
[0;32m[0m
[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : 1.1.8 - Report to user if /var/tmp does not have nodev set] ***********************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 1.1.9 - Report to user if /var/tmp does not have nosuid set] **********************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 1.1.10 - Report to user if /var/tmp does not have noexec set] *********************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security :  Ensure /dev/shm is configured
 1.1.15 Ensure nodev option set on /dev/shm partition
 1.1.16 Ensure nosuid option set on /dev/shm partition
 1.1.17 Ensure noexec option set on /dev/shm partition] ***
[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : Determine if /dev/shm has nodev set] **********************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.1.15 - Report to user] **********************************************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : Determine if /dev/shm has nosuid set] *********************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.1.16 - Report to user] **********************************************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 1.1.17 - Determine if /dev/shm has noexec set] ************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.1.17 - Report to user] **********************************************************************************************************************
[0;33mchanged: [dcex1601tto0b1c] => {[0m
[0;33m    "msg": "FAILED CONTROL: /dev/shm does not have noexec set"[0m
[0;33m}[0m

TASK [cis_security : 1.1.21 - Ensure sticky bit is set on world-writeable directories] *****************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 1.1.23 Ensure mounting of usb-storage is disabled] ********************************************************************************************
[0;31m--- before: /etc/modprobe.d/usb-storage.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/usb-storage.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install usb-storage /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1601tto0b1c] => (item={'From': '(?m)^\\S+\\s+install usb-storage', 'To': 'install usb-storage /bin/true'})[0m
[0;31m--- before: /etc/modprobe.d/usb-storage.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/usb-storage.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+blacklist usb-storage[0m
[0;32m[0m
[0;33mchanged: [dcex1601tto0b1c] => (item={'From': '(?m)^\\S+\\s+blacklist usb-storage', 'To': 'blacklist usb-storage'})[0m

TASK [cis_security : 1.1.23 Ensure mounting of usb-storage is disabled | modprobe] *********************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.2.4 - set master yum.conf gpgcheck to '1'] **************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.2.4 - set master dnf.conf gpgcheck to '1'] **************************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 1.2.4 - find all repo files in /etc/yum.repos.d/] *********************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.2.4 - Set all repos gpgchecks to '1'] *******************************************************************************************************
[0;32mok: [dcex1601tto0b1c] => (item={'path': '/etc/yum.repos.d/epel-modular.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 1680, 'inode': 8591361, 'dev': 64768, 'nlink': 1, 'atime': 1690376358.921476, 'mtime': 1681737779.0, 'ctime': 1690376355.8864317, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1601tto0b1c] => (item={'path': '/etc/yum.repos.d/epel-testing-modular.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 1779, 'inode': 8591362, 'dev': 64768, 'nlink': 1, 'atime': 1690376358.922476, 'mtime': 1681737779.0, 'ctime': 1690376355.8864317, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1601tto0b1c] => (item={'path': '/etc/yum.repos.d/epel-testing.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 1431, 'inode': 8591363, 'dev': 64768, 'nlink': 1, 'atime': 1690376358.922476, 'mtime': 1681737779.0, 'ctime': 1690376355.8864317, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1601tto0b1c] => (item={'path': '/etc/yum.repos.d/epel.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 1332, 'inode': 8591364, 'dev': 64768, 'nlink': 1, 'atime': 1690376358.922476, 'mtime': 1681737779.0, 'ctime': 1690376355.8864317, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1601tto0b1c] => (item={'path': '/etc/yum.repos.d/hashicorp.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 381, 'inode': 8680754, 'dev': 64768, 'nlink': 1, 'atime': 1690376435.7888165, 'mtime': 1597786395.0, 'ctime': 1690376434.9227996, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1601tto0b1c] => (item={'path': '/etc/yum.repos.d/redhat.repo', 'mode': '0640', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 6973, 'inode': 8591360, 'dev': 64768, 'nlink': 1, 'atime': 1690376532.3144841, 'mtime': 1690376532.1214805, 'ctime': 1690376532.1214805, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': False, 'xoth': False, 'isuid': False, 'isgid': False})[0m

TASK [cis_security : 1.3.1 - Ensure sudo is installed] *************************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.3.2 - Ensure sudo commands use pty] *********************************************************************************************************
[0;31m--- before: /etc/sudoers (content)[0m
[0;31m[0m[0;32m+++ after: /etc/sudoers (content)[0m
[0;32m[0m[0;36m@@ -48,6 +48,7 @@[0m
[0;36m[0m # Cmnd_Alias DRIVERS = /sbin/modprobe
 
 # Defaults specification
[0;32m+Defaults use_pty[0m
[0;32m[0m 
 #
 # Refuse to run if unable to disable echo on the tty.

[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : 1.3.3 - Ensure sudo log file exists] **********************************************************************************************************
[0;31m--- before: /etc/sudoers (content)[0m
[0;31m[0m[0;32m+++ after: /etc/sudoers (content)[0m
[0;32m[0m[0;36m@@ -48,6 +48,7 @@[0m
[0;36m[0m # Cmnd_Alias DRIVERS = /sbin/modprobe
 
 # Defaults specification
[0;32m+Defaults logfile="/var/log/sudoers"[0m
[0;32m[0m 
 #
 # Refuse to run if unable to disable echo on the tty.

[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : 1.4.1 Ensure aide is installed] ***************************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.4.1 - Determine if AIDE has already been initialized] ***************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.4.1 - Set up database file location] ********************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.4.1 - Set up database_out file location] ****************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.4.1 - enable gzip compression for database] *************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.4.1 - Move the newly created database into place] *******************************************************************************************
[0;31mfatal: [dcex1601tto0b1c]: FAILED! => {"changed": false, "msg": "Source /var/lib/aide/aide.db.new.gz not found"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 1.5.0 - Check if the EFI directory exists] ****************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.5.1 - set variable for grub.cfg in EFI location] ********************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 1.5.0 - Check if the LILO path exists] ********************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.5.1 - set variable for grub.cfg in LILO location] *******************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.5.1 - Set permissions on grub.cfg] **********************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0644",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/boot/grub2/grub.cfg"
 }

[0;33mchanged: [dcex1601tto0b1c] => (item=/boot/grub2/grub.cfg)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0644",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/boot/grub2/grubenv"
 }

[0;33mchanged: [dcex1601tto0b1c] => (item=/boot/grub2/grubenv)[0m

TASK [cis_security : 1.5.3 - Check if root has a password] *********************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.5.3 - Set root password] ********************************************************************************************************************
[0;35m[DEPRECATION WARNING]: Encryption using the Python crypt module is deprecated. The Python crypt module is deprecated and will be removed from Python 3.13. Install [0m
[0;35mthe passlib library for continued encryption functionality. This feature will be removed in version 2.17. Deprecation warnings can be disabled by setting [0m
[0;35mdeprecation_warnings=False in ansible.cfg.[0m
[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : 1.5.3 - Set single user to use use a secure shell] ********************************************************************************************
[0;32mok: [dcex1601tto0b1c] => (item=rescue.service)[0m
[0;32mok: [dcex1601tto0b1c] => (item=emergency.service)[0m

TASK [cis_security : 1.5.3 - If no root password is set up, notify the user and do not set password or single user mode] *******************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 1.6.1 - Ensure core dumps are restricted] *****************************************************************************************************
[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : 1.6.2 - Ensure address space layout reandomization (ASLR) is enabled] *************************************************************************
[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : 1.8.1.1 - Ensure message of the day is configured properly] ***********************************************************************************
[0;31m--- before: /etc/motd[0m
[0;31m[0m[0;32m+++ after: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/files/banner[0m
[0;32m[0m[0;36m@@ -0,0 +1,6 @@[0m
[0;36m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m
[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : 1.8.1.2 - Install issue banners] **************************************************************************************************************
[0;31m--- before: /etc/issue[0m
[0;31m[0m[0;32m+++ after: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/files/issue[0m
[0;32m[0m[0;36m@@ -1,3 +1,6 @@[0m
[0;36m[0m[0;31m-\S[0m
[0;31m[0m[0;31m-Kernel \r on an \m[0m
[0;31m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m 

[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : 1.8.1.3 - Install issue.net banners] **********************************************************************************************************
[0;31m--- before: /etc/issue.net[0m
[0;31m[0m[0;32m+++ after: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/files/issue[0m
[0;32m[0m[0;36m@@ -1,2 +1,6 @@[0m
[0;36m[0m[0;31m-\S[0m
[0;31m[0m[0;31m-Kernel \r on an \m[0m
[0;31m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m
[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : 1.8.2 Ensure GDM banner set up] ***************************************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 1.10.0 - Display error if crypto variable violates policy] ************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 1.10.0 - Set crypto-policy to DEFAULT] ********************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 1.10.0 - Check to see if FIPS mode is already set up if crypto_policy == "FIPS"] **************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 1.10.0 - Enabling FIPS mode if crypt_policy set to FIPS] **************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 2.1.1 - Remove xinetd service] ****************************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.1.1 - Verify chrony is  installed] ********************************************************************************************************
[0;31mfatal: [dcex1601tto0b1c]: FAILED! => {"changed": false, "module_stderr": "", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": -9}[0m
[0;36m...ignoring[0m

TASK [cis_security : 2.2.1.2 - Configure chrony] *******************************************************************************************************************
[0;31m--- before: /etc/chrony.conf[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-1428455p997vc0e/tmpn01e4hlb/chrony.conf[0m
[0;32m[0m[0;36m@@ -1,4 +1,5 @@[0m
[0;36m[0m[0;31m-[0m
[0;31m[0m[0;32m+# Use public servers from the pool.ntp.org project.[0m
[0;32m[0m[0;32m+# Please consider joining the pool (http://www.pool.ntp.org/join.html).[0m
[0;32m[0m server uxtime1.gfk.de iburst
 server uxtime2.gfk.de iburst
 
[0;36m@@ -26,11 +27,13 @@[0m
[0;36m[0m #local stratum 10
 
 # Specify file containing keys for NTP authentication.
[0;31m-#keyfile /etc/chrony.keys[0m
[0;31m[0m[0;32m+keyfile /etc/chrony.keys[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m[0;32m+# Get TAI-UTC offset and leap seconds from the system tz database.[0m
[0;32m[0m[0;32m+leapsectz right/UTC[0m
[0;32m[0m 
 # Specify directory for log files.
 logdir /var/log/chrony
 
 # Select which information is logged.
 #log measurements statistics tracking
[0;31m-[0m
[0;31m[0m
[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.2 - get default runlevel] *****************************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.2 - Disable the gdm display manager] ******************************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.2 - Set current runlevel (non graphical)] *************************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.2 - Set current runlevel (graphical)] *****************************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.2 - Set default runlevel (non graphical)] *************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/etc/systemd/system/default.target",
[0;31m-    "src": "/lib/systemd/system/multi-user.target"[0m
[0;31m[0m[0;32m+    "src": "/usr/lib/systemd/system/multi-user.target"[0m
[0;32m[0m }

[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.2 - Set default runlevel (graphical)] *****************************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : create empty list for unneeded packages] ******************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.3 - Remove rsync; add to removal list] ****************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.4 - Remove avahi; add to removal list] ****************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.5 - Remove snmp; add to removal list] *****************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.6 - Remove squid; add to removal list] ****************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.7 Check is Samba is operational] **********************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.7 Check for log files] ********************************************************************************************************************
[1;35m[WARNING]: Skipped '/var/log/samba/' path due to this access issue: '/var/log/samba/' is not a directory[0m
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.7 Cheking for Samba logs] *****************************************************************************************************************
[0;32mok: [dcex1601tto0b1c] => {[0m
[0;32m    "smbd_logs.matched": "0"[0m
[0;32m}[0m

TASK [cis_security : 2.2.7 Cheking for Samba service] **************************************************************************************************************
[0;32mok: [dcex1601tto0b1c] => {[0m
[0;32m    "smbd_service.status.ActiveState": "inactive"[0m
[0;32m}[0m

TASK [cis_security : 2.2.7 - Remove samba; add to removal list] ****************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.8 - Remove dovecot; add to removal list] **************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.9 Check is Httpd is operational] **********************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : Add Httpd to removal list] ********************************************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.10 - Remove vsftpd; add to removal list] **************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.11 - Remove bind; add to removal list] ****************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.[12-13] Check for nfs in /etc/fstab] ******************************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.[12-13] Check for nfs shares] *************************************************************************************************************
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.[12-13] Fstab result] *********************************************************************************************************************
[0;32mok: [dcex1601tto0b1c] => {[0m
[0;32m    "nfs_mp.stdout": ""[0m
[0;32m}[0m

TASK [cis_security : 2.2.[12-13] Nfs shares found] *****************************************************************************************************************
[0;32mok: [dcex1601tto0b1c] => {[0m
[0;32m    "nfs_shares.stdout": ""[0m
[0;32m}[0m

TASK [cis_security : 2.2.[12-13] - Remove nfs server; add to removal list] *****************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.15 - Disable dhcpd server [controlled by host variable dhcp_server]; add to removal list] *************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.17 - Remove ypserv; add to removal list] **************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.3.1 - Remove ypbind; add to removal list] ***************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.3.2 - Remove telnet; add to removal list] ***************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.3.3 - Remove openldap-clients; add to removal list] *****************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.3.3 - list of packages to remove] ***********************************************************************************************************
[0;32mok: [dcex1601tto0b1c] => {[0m
[0;32m    "unneeded_packages": [[0m
[0;32m        "rsync",[0m
[0;32m        "avahi",[0m
[0;32m        "net-snmp",[0m
[0;32m        "net-snmp-libs",[0m
[0;32m        "squid",[0m
[0;32m        "samba",[0m
[0;32m        "dovecot",[0m
[0;32m        "vsftpd",[0m
[0;32m        "bind",[0m
[0;32m        "unbound",[0m
[0;32m        "nfs-utils",[0m
[0;32m        "rpcbind",[0m
[0;32m        "dhcp",[0m
[0;32m        "ypserv",[0m
[0;32m        "ypbind",[0m
[0;32m        "telnet",[0m
[0;32m        "openldap-clients"[0m
[0;32m    ][0m
[0;32m}[0m

TASK [cis_security : Process removal list] *************************************************************************************************************************
[0;33mchanged: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.16 - Disable cups as we my not be able to uninstall it] ***********************************************************************************
[0;36mskipping: [dcex1601tto0b1c] => (item=cups.service) [0m
[0;36mskipping: [dcex1601tto0b1c] => (item=cups.socket) [0m
[0;36mskipping: [dcex1601tto0b1c] => (item=cups-browsed.service) [0m
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.18 - Find if we have a mail agent config file] ********************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : 2.2.18 - If the file exists and not a mail server, then set loopback only] ********************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : Check for runing docker] **********************************************************************************************************************
[0;32mok: [dcex1601tto0b1c][0m

TASK [cis_security : Docker service status] ************************************************************************************************************************
[0;32mok: [dcex1601tto0b1c] => {[0m
[0;32m    "docker_service.status.ActiveState": "inactive"[0m
[0;32m}[0m

TASK [cis_security : 3.1.1 - Set ipv4 networking parameters (OFF)] *************************************************************************************************
[0;33mchanged: [dcex1601tto0b1c] => (item=net.ipv4.conf.all.forwarding)[0m

TASK [cis_security : 3.1.1 - Set ipv6 networking parameters (OFF)] *************************************************************************************************
[0;36mskipping: [dcex1601tto0b1c] => (item=net.ipv6.conf.all.forwarding) [0m
[0;36mskipping: [dcex1601tto0b1c][0m

TASK [cis_security : 3.1.2 - Set ipv4 networking parameters (OFF)] *************************************************************************************************
[0;33mchanged: [dcex1601tto0b1c] => (item=net.ipv4.conf.all.send_redirects)[0m
[0;33mchanged: [dcex1601tto0b1c] => (item=net.ipv4.conf.default.send_redirects)[0m

TASK [cis_security : 3.2 - Set ipv4 network parameters (OFF)] ******************************************************************************************************
[0;33mchanged: [dcex1601tto0b1c] => (item=net.ipv4.conf.all.accept_source_route)[0m
[0;33mchanged: [dcex1601tto0b1c] => (item=net.ipv4.conf.default.accept_source_route)[0m
[0;31mfailed: [dcex1601tto0b1c] (item=net.ipv4.conf.all.accept_redirects) => {"ansible_loop_var": "item", "changed": false, "item": "net.ipv4.conf.all.accept_redirects", "module_stderr": "", "module_stdout": "", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": -9}[0m
[0;33mchanged: [dcex1601tto0b1c] => (item=net.ipv4.conf.default.accept_redirects)[0m
[0;33mchanged: [dcex1601tto0b1c] => (item=net.ipv4.conf.all.secure_redirects)[0m
[0;33mchanged: [dcex1601tto0b1c] => (item=net.ipv4.conf.default.secure_redirects)[0m

PLAY RECAP *********************************************************************************************************************************************************
[0;31mdcex1601tto0b1c[0m            : [0;32mok=80  [0m [0;33mchanged=22  [0m unreachable=0    [0;31mfailed=1   [0m [0;36mskipped=22  [0m rescued=0    [1;35mignored=2   [0m


Script done on 2023-07-26 15:35:42+02:00
