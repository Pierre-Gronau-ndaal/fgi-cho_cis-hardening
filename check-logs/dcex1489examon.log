Script started on 2023-07-18 15:44:40+02:00
[0;35m[DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. See https://docs.ansible.com/ansible-core/2.14/user_guide/playbooks_reuse_includes.html for details.[0m
[0;35m This feature will be removed in version 2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.[0m

PLAY [all] **********************************************************************************************************************************************************************************

TASK [Gathering Facts] **********************************************************************************************************************************************************************
[1;35m[WARNING]: Platform linux on host dcex1489examon is using the discovered Python interpreter at /usr/bin/python3.11, but future installation of another Python interpreter could change the[0m
[1;35mmeaning of that path. See https://docs.ansible.com/ansible-core/2.14/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [dcex1489examon][0m

TASK [cis_security : include] ***************************************************************************************************************************************************************
[0;35m[DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks/import_playbook instead. This feature will be removed in version 2.16. Deprecation warnings can be disabled [0m
[0;35mby setting deprecation_warnings=False in ansible.cfg.[0m
[0;36mincluded: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/CIS-OracleLinux-8.yml for dcex1489examon[0m

TASK [cis_security : include] ***************************************************************************************************************************************************************
[1;35m[WARNING]: While constructing a mapping from /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/oracle-8-type.yml, line 968, column 5, found a duplicate dict[0m
[1;35mkey (tags). Using last defined value only.[0m
[0;36mincluded: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/oracle-8-type.yml for dcex1489examon[0m

TASK [cis_security : Print Header] **********************************************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "msg": "CIS Controls for OracleLinux 8"[0m
[0;32m}[0m

TASK [cis_security : Collect package list] **************************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.1.1.1 Ensure mounting of cramfs filesystems is disabled] *************************************************************************************************************
[0;32mok: [dcex1489examon] => (item={'From': '(?m)^\\S+\\s+install cramfs', 'To': 'install cramfs /bin/true'})[0m
[0;32mok: [dcex1489examon] => (item={'From': '(?m)^\\S+\\s+blacklist cramfs', 'To': 'blacklist cramfs'})[0m

TASK [cis_security : 1.1.1.1 Ensure mounting of cramfs filesystems is disabled | modprobe] **************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : Get file system] *******************************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : debug] *****************************************************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "filesystem.stdout": ""[0m
[0;32m}[0m

TASK [cis_security : Check /tmp config] *****************************************************************************************************************************************************
[0;33mchanged: [dcex1489examon][0m

TASK [cis_security : Remount /tmp] **********************************************************************************************************************************************************
[0;33mchanged: [dcex1489examon][0m

TASK [cis_security : Get file system] *******************************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : debug] *****************************************************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "varsystem.stdout": ""[0m
[0;32m}[0m

TASK [cis_security : Check /var config] *****************************************************************************************************************************************************
[0;33mchanged: [dcex1489examon][0m

TASK [cis_security : Remount /var] **********************************************************************************************************************************************************
[0;33mchanged: [dcex1489examon][0m

TASK [cis_security : 1.1.4 Ensure nodev option set on /var/tmp partitions] ******************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : /var/tmp partitions] ***************************************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "msg": {[0m
[0;32m        "changed": false,[0m
[0;32m        "cmd": "mount | grep \"on /var\" && true || true\n",[0m
[0;32m        "delta": null,[0m
[0;32m        "end": null,[0m
[0;32m        "failed": false,[0m
[0;32m        "msg": "Command would have run if not in check mode",[0m
[0;32m        "rc": 0,[0m
[0;32m        "skipped": true,[0m
[0;32m        "start": null,[0m
[0;32m        "stderr": "",[0m
[0;32m        "stderr_lines": [],[0m
[0;32m        "stdout": "",[0m
[0;32m        "stdout_lines": [][0m
[0;32m    }[0m
[0;32m}[0m

TASK [cis_security : Get file system] *******************************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : debug] *****************************************************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "varlogsystem.stdout": ""[0m
[0;32m}[0m

TASK [cis_security : Check /var/log config] *************************************************************************************************************************************************
[0;33mchanged: [dcex1489examon][0m

TASK [cis_security : Remount /var/log] ******************************************************************************************************************************************************
[0;33mchanged: [dcex1489examon][0m

TASK [cis_security : Get file system] *******************************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : debug] *****************************************************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "varauditsystem.stdout": ""[0m
[0;32m}[0m

TASK [cis_security : Check /var/log/audit config] *******************************************************************************************************************************************
[0;33mchanged: [dcex1489examon][0m

TASK [cis_security : Remount /var/log/audit] ************************************************************************************************************************************************
[0;33mchanged: [dcex1489examon][0m

TASK [cis_security : Get file system] *******************************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : debug] *****************************************************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "homesystem.stdout": ""[0m
[0;32m}[0m

TASK [cis_security : Check /home config] ****************************************************************************************************************************************************
[0;33mchanged: [dcex1489examon][0m

TASK [cis_security : Remount /home] *********************************************************************************************************************************************************
[0;33mchanged: [dcex1489examon][0m

TASK [cis_security :  Ensure /dev/shm is configured
 1.1.8.1 Ensure nodev option set on /dev/shm partition
 1.1.8.2 Ensure nosuid option set on /dev/shm partition
 1.1.8.3 Ensure noexec option set on /dev/shm partition] ***
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.1.9 - disable automounting] ******************************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 1.1.23 - Disable USB storage module] ***********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.2.2 - set master yum.conf gpgcheck to '1'] ***************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 1.2.2 - set master dnf.conf gpgcheck to '1'] ***************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 1.2.2 - find all repo files in /etc/yum.repos.d/] **********************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.2.2 - Set all repos gpgchecks to '1'] ********************************************************************************************************************************
[0;32mok: [dcex1489examon] => (item={'path': '/etc/yum.repos.d/redhat.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 5976, 'inode': 2018, 'dev': 64769, 'nlink': 1, 'atime': 1689676195.1244957, 'mtime': 1689676194.9214923, 'ctime': 1689676194.9214923, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m

TASK [cis_security : 1.3.1 Ensure aide is installed] ****************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.3.1 - Determine if AIDE has already been initialized] ****************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.3.1 - Set up database file location] *********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.3.1 - Set up database_out file location] *****************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.3.1 - enable gzip compression for database] **************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.3.1 - Move the newly created database into place] ********************************************************************************************************************
[0;31mfatal: [dcex1489examon]: FAILED! => {"changed": false, "msg": "Source /var/lib/aide/aide.db.new.gz not found"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 1.5.2 - Ensure IgnoreRhosts is set] ************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.5.3 - Ensure address space layout reandomization (ASLR) is enabled] **************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.6.1.1 - Ensure SELinux is installed] *********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : Regather facts] ********************************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.6.1.2 - Ensure SELinux is not disabled in bootloader configuration] **************************************************************************************************
[0;32mok: [dcex1489examon] => (item=selinux=0)[0m
[0;32mok: [dcex1489examon] => (item=enforcing=0)[0m

TASK [cis_security : 1.6.1.6 - Generate report on unconfined running services] **************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 1.6.1.6 - Report on unconfined running services to user] ***************************************************************************************************************
[0;31mfatal: [dcex1489examon]: FAILED! => {"msg": "The conditional check 'unconfined_services_out.stdout' failed. The error was: error while evaluating conditional (unconfined_services_out.stdout): 'dict object' has no attribute 'stdout'. 'dict object' has no attribute 'stdout'\n\nThe error appears to be in '/home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/oracle-8-type.yml': line 548, column 9, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n      # Print any findings to the user\n      - name: 1.6.1.6 - Report on unconfined running services to user\n        ^ here\n"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 1.6.1.7 - Remove setroubleshoot] ***************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.6.1.8 - Remove MCS Translation Service] ******************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.7.1 - Install motd banners] ******************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.7.2 - Install issue banners] *****************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.8.1.3 - Install issue.net banners] ***********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.8.2 Ensure GDM banner set up] ****************************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 1.10.0 - Display error if crypto variable violates policy] *************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 1.10.0 - Set crypto-policy to DEFAULT] *********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 1.10.0 - Check to see if FIPS mode is already set up if crypto_policy == "FIPS"] ***************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 1.10.0 - Enabling FIPS mode if crypt_policy set to FIPS] ***************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 2.1.1 - Verify chrony is  installed] ***********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.1.2 - Configure chrony] **********************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.1.3 - configure sysconfig time_server options] ***********************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : create empty list for unneeded packages] *******************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.1 - Remove xinetd service] *****************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.2 - Ensure xorg-x11-server-common is not installed] ****************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.3 - Remove avahi; add to removal list] *****************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.4 - Disable dhcpd server [controlled by host variable dhcp_server]; add to removal list] ***************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.5 - Disable dhcpd server [controlled by host variable dhcp_server]; add to removal list] ***************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.6 - Remove bind; add to removal list] ******************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.7 - Remove ftp; add to removal list] *******************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.8 - Remove vsftpd; add to removal list] ****************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.9 - Remove tftp; add to removal list] ******************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.10 Check is Httpd is operational] **********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : show value] ************************************************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "httpd_service.status.ActiveState": "inactive"[0m
[0;32m}[0m

TASK [cis_security : Add Httpd to removal list] *********************************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 2.2.11 - Remove dovecot; add to removal list] **************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.12 Check is Samba is operational] **********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.12 Check for log files] ********************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.12 Cheking for Samba logs] *****************************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "smbd_logs.matched": "0"[0m
[0;32m}[0m

TASK [cis_security : 2.2.12 Cheking for Samba service] **************************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "smbd_service.status.ActiveState": "inactive"[0m
[0;32m}[0m

TASK [cis_security : 2.2.12 - Remove samba; add to removal list] ****************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.13 - Remove squid; add to removal list] ****************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.14 - Remove snmp; add to removal list] *****************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.15 - Remove ypserv; add to removal list] ***************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.16 - Remove telnet; add to removal list] ***************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.[18-19] Check for nfs in /etc/fstab] *******************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 2.2.[18-19] Check for nfs shares] **************************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 2.2.[18-19] Fstab result] **********************************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "nfs_mp.stdout": ""[0m
[0;32m}[0m

TASK [cis_security : 2.2.[18-19] Nfs shares found] ******************************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "nfs_shares.stdout": ""[0m
[0;32m}[0m

TASK [cis_security : 2.2.[18-19] - Remove nfs server; add to removal list] ******************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.20 - Remove rsync; add to removal list] ****************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.3.1 - Remove ypbind; add to removal list] ****************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.3.2 - Remove rsh; add to removal list] *******************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.3.3 - Ensure talk client is not installed] ***************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.3.5 - Remove openldap-clients; add to removal list] ******************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.[2-3] - list of packages to remove] **********************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "unneeded_packages": [[0m
[0;32m        "xinetd",[0m
[0;32m        "avahi",[0m
[0;32m        "avahi-autoipd",[0m
[0;32m        "cups",[0m
[0;32m        "dhcp-server",[0m
[0;32m        "bind",[0m
[0;32m        "unbound",[0m
[0;32m        "ftp",[0m
[0;32m        "vsftpd",[0m
[0;32m        "tftp-server",[0m
[0;32m        "tftp",[0m
[0;32m        "dovecot",[0m
[0;32m        "cyrus-imapd",[0m
[0;32m        "samba",[0m
[0;32m        "squid",[0m
[0;32m        "net-snmp",[0m
[0;32m        "ypserv",[0m
[0;32m        "telnet",[0m
[0;32m        "nfs-utils",[0m
[0;32m        "rpcbind",[0m
[0;32m        "rsync",[0m
[0;32m        "ypbind",[0m
[0;32m        "rsh",[0m
[0;32m        "talk",[0m
[0;32m        "openldap-clients"[0m
[0;32m    ][0m
[0;32m}[0m

TASK [cis_security : Process removal list] **************************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.17 - Find if we have a mail agent config file] *********************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 2.2.17 - If the file exists and not a mail server, then set loopback only] *********************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : Check for runing docker] ***********************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : Docker service status] *************************************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "docker_service.status.ActiveState": "inactive"[0m
[0;32m}[0m

TASK [cis_security : 3.1.1 - Set ipv4 networking parameters (OFF)] **************************************************************************************************************************
[0;32mok: [dcex1489examon] => (item=net.ipv4.conf.all.forwarding)[0m

TASK [cis_security : 3.1.1 - Set ipv6 networking parameters (OFF)] **************************************************************************************************************************
[0;36mskipping: [dcex1489examon] => (item=net.ipv6.conf.all.forwarding) [0m
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 3.1.2 - Set ipv4 networking parameters (OFF)] **************************************************************************************************************************
[0;32mok: [dcex1489examon] => (item=net.ipv4.conf.all.send_redirects)[0m
[0;32mok: [dcex1489examon] => (item=net.ipv4.conf.default.send_redirects)[0m

TASK [cis_security : 3.2 - Set ipv4 network parameters (OFF)] *******************************************************************************************************************************
[0;32mok: [dcex1489examon] => (item=net.ipv4.conf.all.accept_source_route)[0m
[0;32mok: [dcex1489examon] => (item=net.ipv4.conf.default.accept_source_route)[0m
[0;32mok: [dcex1489examon] => (item=net.ipv4.conf.all.accept_redirects)[0m
[0;32mok: [dcex1489examon] => (item=net.ipv4.conf.default.accept_redirects)[0m
[0;32mok: [dcex1489examon] => (item=net.ipv4.conf.all.secure_redirects)[0m
[0;32mok: [dcex1489examon] => (item=net.ipv4.conf.default.secure_redirects)[0m

TASK [cis_security : 3.2.[4-8] - Set ipv4 networking parameters (ON)] ***********************************************************************************************************************
[0;32mok: [dcex1489examon] => (item=net.ipv4.conf.all.log_martians)[0m
[0;32mok: [dcex1489examon] => (item=net.ipv4.conf.default.log_martians)[0m
[0;32mok: [dcex1489examon] => (item=net.ipv4.icmp_echo_ignore_broadcasts)[0m
[0;32mok: [dcex1489examon] => (item=net.ipv4.icmp_ignore_bogus_error_responses)[0m
[0;32mok: [dcex1489examon] => (item=net.ipv4.conf.all.rp_filter)[0m
[0;32mok: [dcex1489examon] => (item=net.ipv4.conf.default.rp_filter)[0m
[0;32mok: [dcex1489examon] => (item=net.ipv4.tcp_syncookies)[0m

TASK [cis_security : 3.2 - Set ipv6 networking parameters (OFF)] ****************************************************************************************************************************
[0;36mskipping: [dcex1489examon] => (item=net.ipv6.conf.all.accept_source_route) [0m
[0;36mskipping: [dcex1489examon] => (item=net.ipv6.conf.default.accept_source_route) [0m
[0;36mskipping: [dcex1489examon] => (item=net.ipv6.conf.all.accept_redirects) [0m
[0;36mskipping: [dcex1489examon] => (item=net.ipv6.conf.default.accept_redirects) [0m
[0;36mskipping: [dcex1489examon] => (item=net.ipv6.conf.all.accept_ra) [0m
[0;36mskipping: [dcex1489examon] => (item=net.ipv6.conf.default.accept_ra) [0m
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 3.4.1.1 - Install firewalld] *******************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 3.4.2.2 - Disable iptables service] ************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 3.4.2.3 - Disable netfilters service] **********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 3.4.1.5 - Set default zone] ********************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : Notify users to configure the firewall] ********************************************************************************************************************************
[0;32mok: [dcex1489examon] => {[0m
[0;32m    "msg": [[0m
[0;32m        "3.4.2.7 - Ensure default firewalld policy must be handled locally"[0m
[0;32m    ][0m
[0;32m}[0m

TASK [cis_security : 3.6 - Find if IPv6 is currently in the grub file, shows changed when it is in the file] ********************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 3.6 - Disable IPv6 in grub] ********************************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 4.2.1.1 - Ensure rsyslog is installed] *********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 4.2.1.2 - Enable Rsyslog] **********************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 4.2.1.3 - Ensure rsyslog default file permissions are configured] ******************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : Find any rsyslog files where all logs are being forwarded to a loghost] ************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 4.2.2.1 - Forward journald logs to rsyslog IF rsyslog is sending logs to a log host] ***********************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 4.2.2.2 - Ensure journald compresses large files] **********************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 4.2.2.3 - Ensure journald writes to peristent disk] ********************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 4.2.3 Ensure permissions on all logfiles are configured] ***************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : Remove /etc/cron.deny] *************************************************************************************************************************************************
[0;32mok: [dcex1489examon] => (item=/etc/cron.deny)[0m
[0;32mok: [dcex1489examon] => (item=/etc/at.deny)[0m

TASK [cis_security : Create the cron/at allow files (5.1.8)] ********************************************************************************************************************************
[0;32mok: [dcex1489examon] => (item=/etc/cron.allow)[0m
[0;32mok: [dcex1489examon] => (item=/etc/at.allow)[0m

TASK [cis_security : 5.1.1 - Ensure cron is enabled] ****************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.1.2 - Ensure permissions on /etc/crontab] ****************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.1.[3-7] - Ensure permissions on crontab directories] *****************************************************************************************************************
[0;32mok: [dcex1489examon] => (item=/etc/cron.hourly)[0m
[0;32mok: [dcex1489examon] => (item=/etc/cron.daily)[0m
[0;32mok: [dcex1489examon] => (item=/etc/cron.weekly)[0m
[0;32mok: [dcex1489examon] => (item=/etc/cron.monthly)[0m
[0;32mok: [dcex1489examon] => (item=/etc/cron.d)[0m

TASK [cis_security : 5.2.1 - Set permissions on SSH file] ***********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.3 - Find all ssh private host keys] ********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.3 - Set permissions on all ssh private host keys (Red Hat set the group to ssh_keys and mode to 640)] **************************************************************
[0;32mok: [dcex1489examon] => (item={'path': '/etc/ssh/ssh_host_rsa_key', 'mode': '0640', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 999, 'size': 1679, 'inode': 197062, 'dev': 64769, 'nlink': 1, 'atime': 1689667982.1036608, 'mtime': 1490965810.9919999, 'ctime': 1490965811.0019999, 'gr_name': 'ssh_keys', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': False, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1489examon] => (item={'path': '/etc/ssh/ssh_host_ecdsa_key', 'mode': '0640', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 999, 'size': 227, 'inode': 196965, 'dev': 64769, 'nlink': 1, 'atime': 1689667982.105661, 'mtime': 1490965811.033, 'ctime': 1490965811.0479999, 'gr_name': 'ssh_keys', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': False, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1489examon] => (item={'path': '/etc/ssh/ssh_host_ed25519_key', 'mode': '0640', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 999, 'size': 387, 'inode': 196967, 'dev': 64769, 'nlink': 1, 'atime': 1689667982.107661, 'mtime': 1490965811.053, 'ctime': 1490965811.054, 'gr_name': 'ssh_keys', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': False, 'xoth': False, 'isuid': False, 'isgid': False})[0m

TASK [cis_security : 5.2.4 - Find all ssh public host keys] *********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.4 - Set permissions on all ssh public host keys] *******************************************************************************************************************
[0;32mok: [dcex1489examon] => (item={'path': '/etc/ssh/ssh_host_rsa_key.pub', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 382, 'inode': 197067, 'dev': 64769, 'nlink': 1, 'atime': 1689667982.104661, 'mtime': 1490965810.9919999, 'ctime': 1490965811.004, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1489examon] => (item={'path': '/etc/ssh/ssh_host_ecdsa_key.pub', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 162, 'inode': 196966, 'dev': 64769, 'nlink': 1, 'atime': 1689667982.1066608, 'mtime': 1490965811.033, 'ctime': 1490965811.0489998, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1489examon] => (item={'path': '/etc/ssh/ssh_host_ed25519_key.pub', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 82, 'inode': 196968, 'dev': 64769, 'nlink': 1, 'atime': 1689667982.107661, 'mtime': 1490965811.053, 'ctime': 1490965811.0549998, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m

TASK [cis_security : 5.2.5 - Set LogLevel to INFO or more verbose, but not debug] ***********************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.6 - Ensure SSH is configured to use PAM] ***************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.8 - Ensure HostbasedAuthentication is disabled] ********************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.9 - Ensure SSH PermitEmptyPasswords is disabled] *******************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.10 - Ensure PermitUserEnvironment is disabled] *********************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.11 - Ensure IgnoreRhosts is set] ***********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.15 - Ensure SSH Banner is configured] ******************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.16 - Ensure SSH MaxAuthTires is set to 2 or less] ******************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.17 - Limit max unauthenticated startups] ***************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.18 - Limit max sessions] *******************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.19 - Ensure SSH LoginGraceTime is set to 30 or less] ***************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.20 - Ensure SSH Idle Timeout is configured ClientAliveInterval] ****************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.2.20 - Ensure SSH Idle Timeout is configured ClientAliveCountMax] ****************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.3.1 - Ensure sudo is installed] **************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.3.2 - Ensure sudo commands use pty] **********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.3.3 - Ensure sudo log file exists] ***********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.5.1 - require at least one digit in passwords] ***********************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.5.1 - require at least one uppercase letter in passwords] ************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.5.1 - require at least one lowercase letter in passwords] ************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.5.1 - Require at least one special character in passwords] ***********************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.5.1 - Require at least 14 characters in passwords] *******************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : add deny] **************************************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.5.2 add unlock_time] *************************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.5.3/5.5.4 PAM checks] ************************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.5.3 Ensure password reuse is limited | update file according to CIS] *************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.5.3/5.5.4 PAM checks] ************************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.5.4 Ensure password reuse is limited | update /etc/pam.d/system-auth] ************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.5.4 Ensure password reuse is limited | update /etc/pam.d/password-auth] **********************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.5.4 Setting password hashing algorithm is sha512 / libuser.conf] *****************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.5.4 Setting password hashing algorithm is sha512 / /etc/login.defs] **************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.6.1.2 - Ensure password change days is set to 0] *********************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.6.1.3 - Ensure password warning days is set to 7] ********************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.6.1.5 Ensure all users last password change date is in the past | get list] ******************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 5.6.1.5 Ensure all users last password change date is in the past | save list] *****************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-135172pul6g4s1/tmp_qaokrcv[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcex1489examon][0m

TASK [cis_security : 5.6.3 - Ensure default shell timeout is 900 seconds or less] ***********************************************************************************************************
[0;32mok: [dcex1489examon] => (item=/etc/profile)[0m

TASK [cis_security : 5.6.4 - Ensure default group for root is GID 0] ************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 5.6.5 - Ensure umask is set] *******************************************************************************************************************************************
[0;32mok: [dcex1489examon] => (item=/etc/bashrc)[0m
[0;32mok: [dcex1489examon] => (item=/etc/profile)[0m

TASK [cis_security : 5.7 - Configure PAM to only allow su from wheel group] *****************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 5.7 - Add root to the wheel group] *************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.1.2 - Find any world writiable files directories] ********************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.1.2 - Print any world writable directories found] ********************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.1.2 Remove any world writiable files directories] ********************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.1.[3,9] - Ensure permissions on /etc/passwd /etc/group] **************************************************************************************************************
[0;32mok: [dcex1489examon] => (item=gshadow-)[0m
[0;32mok: [dcex1489examon] => (item=shadow-)[0m
[0;32mok: [dcex1489examon] => (item=shadow)[0m
[0;32mok: [dcex1489examon] => (item=gshadow)[0m

TASK [cis_security : 6.1.[6-10] - Ensure permissions on /etc/passwd- /etc/[g]shadow- /etc/group-] *******************************************************************************************
[0;32mok: [dcex1489examon] => (item=passwd)[0m
[0;32mok: [dcex1489examon] => (item=passwd-)[0m
[0;32mok: [dcex1489examon] => (item=group)[0m
[0;32mok: [dcex1489examon] => (item=group-)[0m

TASK [cis_security : 6.1.11 - Find any world writiable files] *******************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.1.11 - Print any world writable files found] *************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.1.12 - Find any unowned files] ***************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.1.12 - Print any unowned files found] ********************************************************************************************************************************
[0;33mchanged: [dcex1489examon] => {[0m
[0;33m    "msg": "unowned files found: /opt/f-secure/mdr/baseguard/services/sensor.1684240395/libexec/systemd_query\n/opt/f-secure/mdr/baseguard/services/sensor.1684240395/libexec/_sensor_config"[0m
[0;33m}[0m

TASK [cis_security : 6.1.13 - Find any ungrouped files] *************************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.1.13 - Print any ungrouped files found] ******************************************************************************************************************************
[0;33mchanged: [dcex1489examon] => {[0m
[0;33m    "msg": "ungrouped files found: /opt/f-secure/mdr/baseguard/services/sensor.1684240395/libexec/systemd_query\n/opt/f-secure/mdr/baseguard/services/sensor.1684240395/libexec/_sensor_config"[0m
[0;33m}[0m

TASK [cis_security : 6.2.1 - Check to see if there are any accounts with empty passwords] ***************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.2.1 - Report the named users to the report] **************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.2.2 - Use script to pull the list of groups] *************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.2.2 - Report to user any unreferenced groups] ************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.2.3 - Use script to pull the list of duplicate UIDs] *****************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.2.3 - Print report of duplicated UIDs to user] ***********************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.2.4 - Use script to pull the list of duplicate GIDs] *****************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.2.4 - Print report of duplcate GIDs to user] *************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.2.5 - Use script to pull the list of users] **************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.2.5 - Print report of duplicate users to user] ***********************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.2.6 - Use script to pull the list of groups] *************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.2.6 - Print report of duplicate groups to user] **********************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.2.7 - Run script on path variable] ***********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.2.7 - Print report to user] ******************************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.2.8 - find accounts with UID of 0] ***********************************************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.2.8 - Report on mulitple accounts with UID of 0] *********************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.2.9 - Use script to find the users] **********************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.2.9 - Print report of users that do not have a home directory] *******************************************************************************************************
[0;31mfatal: [dcex1489examon]: FAILED! => {"msg": "The conditional check 'nohomedir.stdout' failed. The error was: error while evaluating conditional (nohomedir.stdout): 'dict object' has no attribute 'stdout'. 'dict object' has no attribute 'stdout'\n\nThe error appears to be in '/home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/oracle-8-type.yml': line 1907, column 9, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n      - name: 6.2.9 - Print report of users that do not have a home directory\n        ^ here\n"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 6.2.9 Ensure all users' home directories exist | list] *****************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.2.9 Ensure all users' home directories exist | save] *****************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-135172pul6g4s1/tmpoy4qfhnh[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcex1489examon][0m

TASK [cis_security : 6.2.9 Ensure all users' home directories exist | fix] ******************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : 6.2.10 - Determine if the shadow group exists in /etc/group] ***********************************************************************************************************
[0;32mok: [dcex1489examon][0m

TASK [cis_security : 6.2.10 - Print report of shadow group to user] *************************************************************************************************************************
[0;36mskipping: [dcex1489examon][0m

TASK [cis_security : Add hardening file.] ***************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,6 +1,6 @@[0m
[0;36m[0m {
[0;31m-    "atime": 1689684792.3992043,[0m
[0;31m[0m[0;31m-    "mtime": 1689684791.2161853,[0m
[0;31m[0m[0;32m+    "atime": 1689688003.0232527,[0m
[0;32m[0m[0;32m+    "mtime": 1689688003.0232527,[0m
[0;32m[0m     "path": "/etc/.hardening",
[0;31m-    "state": "file"[0m
[0;31m[0m[0;32m+    "state": "touch"[0m
[0;32m[0m }

[0;33mchanged: [dcex1489examon][0m

PLAY RECAP **********************************************************************************************************************************************************************************
[0;33mdcex1489examon[0m             : [0;32mok=172 [0m [0;33mchanged=15  [0m unreachable=0    failed=0    [0;36mskipped=34  [0m rescued=0    [1;35mignored=3   [0m


Script done on 2023-07-18 15:46:43+02:00
