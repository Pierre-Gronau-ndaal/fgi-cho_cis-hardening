Script started on 2023-06-07 12:15:42+02:00
[1;35m[WARNING]: While constructing a mapping from /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/defaults/main.yml, line 6, column 1, found a duplicate dict key (enable_firewall). Using last defined value only.[0m
[1;35m[WARNING]: While constructing a mapping from /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/defaults/main.yml, line 6, column 1, found a duplicate dict key (ssh_max_sessions). Using last defined value only.[0m
[0;35m[DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. See https://docs.ansible.com/ansible-core/2.14/user_guide/playbooks_reuse_includes.html for details. This feature will be removed in version 2.16. [0m
[0;35mDeprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.[0m

PLAY [all] **********************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] **********************************************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : include] ***************************************************************************************************************************************************************************************************************
[0;35m[DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks/import_playbook instead. This feature will be removed in version 2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in [0m
[0;35mansible.cfg.[0m
[0;36mincluded: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/CIS-RedHat-8.yml for dcex1160asmite[0m

TASK [cis_security : include] ***************************************************************************************************************************************************************************************************************
[0;36mincluded: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/redhat-8-type.yml for dcex1160asmite[0m

TASK [cis_security : Print Header] **********************************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite] => {[0m
[0;32m    "msg": "CIS Controls for RedHat 8"[0m
[0;32m}[0m

TASK [cis_security : Collect package list] **************************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.1.1.1 Ensure mounting of cramfs filesystems is disabled] *************************************************************************************************************************************************************
[0;31m--- before: /etc/modprobe.d/cramfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/cramfs.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install cramfs /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite] => (item={'From': '(?m)^\\S+\\s+install cramfs', 'To': 'install cramfs /bin/true'})[0m
[0;31m--- before: /etc/modprobe.d/cramfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/cramfs.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+blacklist cramfs[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite] => (item={'From': '(?m)^\\S+\\s+blacklist cramfs', 'To': 'blacklist cramfs'})[0m

TASK [cis_security : 1.1.1.1 Ensure mounting of cramfs filesystems is disabled | modprobe] **************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.1.1.3 Ensure mounting of squashfs filesystems is disabled] ***********************************************************************************************************************************************************
[0;31m--- before: /etc/modprobe.d/squashfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/squashfs.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install squashfs /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite] => (item={'From': '(?m)^\\S+\\s+install squashfs', 'To': 'install squashfs /bin/true'})[0m
[0;31m--- before: /etc/modprobe.d/squashfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/squashfs.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+blacklist squashfs[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite] => (item={'From': '(?m)^\\S+\\s+blacklist squashfs', 'To': 'blacklist squashfs'})[0m

TASK [cis_security : 1.1.1.3 Ensure mounting of cramfs filesystems is disabled | modprobe] **************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.1.1.4 Ensure mounting of udf filesystems is disabled] ****************************************************************************************************************************************************************
[0;31m--- before: /etc/modprobe.d/udf.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/udf.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install udf /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite] => (item={'From': '(?m)^\\S+\\s+install udf', 'To': 'install udf /bin/true'})[0m
[0;31m--- before: /etc/modprobe.d/udf.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/udf.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+blacklist udf[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite] => (item={'From': '(?m)^\\S+\\s+blacklist udf', 'To': 'blacklist udf'})[0m

TASK [cis_security : 1.1.1.4 Ensure mounting of udf filesystems is disabled | modprobe] *****************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : Ensure the local-fs directory is created] ******************************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,10 +1,4 @@[0m
[0;36m[0m {
     "path": "/etc/systemd/system/local-fs.target.wants",
[0;31m-    "path_content": {[0m
[0;31m[0m[0;31m-        "directories": [],[0m
[0;31m[0m[0;31m-        "files": [[0m
[0;31m[0m[0;31m-            "/etc/systemd/system/local-fs.target.wants/readonly-root.service"[0m
[0;31m[0m[0;31m-        ][0m
[0;31m[0m[0;31m-    },[0m
[0;31m[0m[0;31m-    "state": "directory"[0m
[0;31m[0m[0;32m+    "state": "absent"[0m
[0;32m[0m }

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 1.1.[2-5] - Configure config file for tmpfs] ***************************************************************************************************************************************************************************
[0;31m--- before: /etc/systemd/system/local-fs.target.wants/tmp.mount (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/system/local-fs.target.wants/tmp.mount (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1,7 @@[0m
[0;36m[0m[0;32m+# BEGIN ANSIBLE MANAGED BLOCK[0m
[0;32m[0m[0;32m+[Mount][0m
[0;32m[0m[0;32m+What=tmpfs[0m
[0;32m[0m[0;32m+Where=/tmp[0m
[0;32m[0m[0;32m+Type=tmpfs[0m
[0;32m[0m[0;32m+Options=mode=1777,strictatime,noexec,nodev,nosuid[0m
[0;32m[0m[0;32m+# END ANSIBLE MANAGED BLOCK[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 1.1.8 - Report to user if /var/tmp does not have nodev set] ************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 1.1.9 - Report to user if /var/tmp does not have nosuid set] ***********************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 1.1.10 - Report to user if /var/tmp does not have noexec set] **********************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security :  Ensure /dev/shm is configured
 1.1.15 Ensure nodev option set on /dev/shm partition
 1.1.16 Ensure nosuid option set on /dev/shm partition
 1.1.17 Ensure noexec option set on /dev/shm partition] ***********************
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : Determine if /dev/shm has nodev set] ***********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.1.15 - Report to user] ***********************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : Determine if /dev/shm has nosuid set] **********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.1.16 - Report to user] ***********************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 1.1.17 - Determine if /dev/shm has noexec set] *************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.1.17 - Report to user] ***********************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite] => {[0m
[0;33m    "msg": "FAILED CONTROL: /dev/shm does not have noexec set"[0m
[0;33m}[0m

TASK [cis_security : 1.1.21 - Ensure sticky bit is set on world-writeable directories] ******************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 1.1.23 Ensure mounting of usb-storage is disabled] *********************************************************************************************************************************************************************
[0;31m--- before: /etc/modprobe.d/usb-storage.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/usb-storage.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install usb-storage /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite] => (item={'From': '(?m)^\\S+\\s+install usb-storage', 'To': 'install usb-storage /bin/true'})[0m
[0;31m--- before: /etc/modprobe.d/usb-storage.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/usb-storage.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+blacklist usb-storage[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite] => (item={'From': '(?m)^\\S+\\s+blacklist usb-storage', 'To': 'blacklist usb-storage'})[0m

TASK [cis_security : 1.1.23 Ensure mounting of usb-storage is disabled | modprobe] **********************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.2.4 - set master yum.conf gpgcheck to '1'] ***************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.2.4 - set master dnf.conf gpgcheck to '1'] ***************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 1.2.4 - find all repo files in /etc/yum.repos.d/] **********************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.2.4 - Set all repos gpgchecks to '1'] ********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite] => (item={'path': '/etc/yum.repos.d/redhat.repo', 'mode': '0640', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 6973, 'inode': 8584992, 'dev': 64768, 'nlink': 1, 'atime': 1686128951.6151545, 'mtime': 1686128951.3961518, 'ctime': 1686128951.3961518, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': False, 'xoth': False, 'isuid': False, 'isgid': False})[0m

TASK [cis_security : 1.3.1 - Ensure sudo is installed] **************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.3.2 - Ensure sudo commands use pty] **********************************************************************************************************************************************************************************
[0;31m--- before: /etc/sudoers (content)[0m
[0;31m[0m[0;32m+++ after: /etc/sudoers (content)[0m
[0;32m[0m[0;36m@@ -48,6 +48,7 @@[0m
[0;36m[0m # Cmnd_Alias DRIVERS = /sbin/modprobe
 
 # Defaults specification
[0;32m+Defaults use_pty[0m
[0;32m[0m 
 #
 # Refuse to run if unable to disable echo on the tty.

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 1.3.3 - Ensure sudo log file exists] ***********************************************************************************************************************************************************************************
[0;31m--- before: /etc/sudoers (content)[0m
[0;31m[0m[0;32m+++ after: /etc/sudoers (content)[0m
[0;32m[0m[0;36m@@ -48,6 +48,7 @@[0m
[0;36m[0m # Cmnd_Alias DRIVERS = /sbin/modprobe
 
 # Defaults specification
[0;32m+Defaults logfile="/var/log/sudoers"[0m
[0;32m[0m 
 #
 # Refuse to run if unable to disable echo on the tty.

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 1.4.1 Ensure aide is installed] ****************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.4.1 - Determine if AIDE has already been initialized] ****************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.4.1 - Set up database file location] *********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.4.1 - Set up database_out file location] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.4.1 - enable gzip compression for database] **************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.4.1 - Move the newly created database into place] ********************************************************************************************************************************************************************
[0;31mfatal: [dcex1160asmite]: FAILED! => {"changed": false, "msg": "Source /var/lib/aide/aide.db.new.gz not found"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 1.5.0 - Check if the EFI directory exists] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.5.1 - set variable for grub.cfg in EFI location] *********************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 1.5.0 - Check if the LILO path exists] *********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.5.1 - set variable for grub.cfg in LILO location] ********************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.5.1 - Set permissions on grub.cfg] ***********************************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0644",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/boot/grub2/grub.cfg"
 }

[0;33mchanged: [dcex1160asmite] => (item=/boot/grub2/grub.cfg)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0644",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/boot/grub2/grubenv"
 }

[0;33mchanged: [dcex1160asmite] => (item=/boot/grub2/grubenv)[0m

TASK [cis_security : 1.5.3 - Check if root has a password] **********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.5.3 - Set root password] *********************************************************************************************************************************************************************************************
[0;35m[DEPRECATION WARNING]: Encryption using the Python crypt module is deprecated. The Python crypt module is deprecated and will be removed from Python 3.13. Install the passlib library for continued encryption functionality. This feature [0m
[0;35mwill be removed in version 2.17. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.[0m
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 1.5.3 - Set single user to use use a secure shell] *********************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite] => (item=rescue.service)[0m
[0;32mok: [dcex1160asmite] => (item=emergency.service)[0m

TASK [cis_security : 1.5.3 - If no root password is set up, notify the user and do not set password or single user mode] ********************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 1.6.1 - Ensure core dumps are restricted] ******************************************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 1.6.2 - Ensure address space layout reandomization (ASLR) is enabled] **************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 1.8.1.1 - Ensure message of the day is configured properly] ************************************************************************************************************************************************************
[0;31m--- before: /etc/motd[0m
[0;31m[0m[0;32m+++ after: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/files/banner[0m
[0;32m[0m[0;36m@@ -0,0 +1,6 @@[0m
[0;36m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 1.8.1.2 - Install issue banners] ***************************************************************************************************************************************************************************************
[0;31m--- before: /etc/issue[0m
[0;31m[0m[0;32m+++ after: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/files/issue[0m
[0;32m[0m[0;36m@@ -1,3 +1,6 @@[0m
[0;36m[0m[0;31m-\S[0m
[0;31m[0m[0;31m-Kernel \r on an \m[0m
[0;31m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m 

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 1.8.1.3 - Install issue.net banners] ***********************************************************************************************************************************************************************************
[0;31m--- before: /etc/issue.net[0m
[0;31m[0m[0;32m+++ after: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/files/issue[0m
[0;32m[0m[0;36m@@ -1,2 +1,6 @@[0m
[0;36m[0m[0;31m-\S[0m
[0;31m[0m[0;31m-Kernel \r on an \m[0m
[0;31m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 1.8.2 Ensure GDM banner set up] ****************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 1.10.0 - Display error if crypto variable violates policy] *************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 1.10.0 - Set crypto-policy to DEFAULT] *********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 1.10.0 - Check to see if FIPS mode is already set up if crypto_policy == "FIPS"] ***************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 1.10.0 - Enabling FIPS mode if crypt_policy set to FIPS] ***************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 2.1.1 - Remove xinetd service] *****************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.1.1 - Verify chrony is  installed] *********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.1.2 - Configure chrony] ********************************************************************************************************************************************************************************************
[0;31m--- before: /etc/chrony.conf[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-1214524ywiinf2c/tmp4wfdsxul/chrony.conf[0m
[0;32m[0m[0;36m@@ -1,4 +1,5 @@[0m
[0;36m[0m[0;31m-[0m
[0;31m[0m[0;32m+# Use public servers from the pool.ntp.org project.[0m
[0;32m[0m[0;32m+# Please consider joining the pool (http://www.pool.ntp.org/join.html).[0m
[0;32m[0m server uxtime1.gfk.de iburst
 server uxtime2.gfk.de iburst
 
[0;36m@@ -26,11 +27,13 @@[0m
[0;36m[0m #local stratum 10
 
 # Specify file containing keys for NTP authentication.
[0;31m-#keyfile /etc/chrony.keys[0m
[0;31m[0m[0;32m+keyfile /etc/chrony.keys[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m[0;32m+# Get TAI-UTC offset and leap seconds from the system tz database.[0m
[0;32m[0m[0;32m+leapsectz right/UTC[0m
[0;32m[0m 
 # Specify directory for log files.
 logdir /var/log/chrony
 
 # Select which information is logged.
 #log measurements statistics tracking
[0;31m-[0m
[0;31m[0m
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 2.2.2 - get default runlevel] ******************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.2 - Disable the gdm display manager] *******************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 2.2.2 - Set current runlevel (non graphical)] **************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 2.2.2 - Set current runlevel (graphical)] ******************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 2.2.2 - Set default runlevel (non graphical)] **************************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/etc/systemd/system/default.target",
[0;31m-    "src": "/lib/systemd/system/multi-user.target"[0m
[0;31m[0m[0;32m+    "src": "/usr/lib/systemd/system/multi-user.target"[0m
[0;32m[0m }

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 2.2.2 - Set default runlevel (graphical)] ******************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : create empty list for unneeded packages] *******************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.3 - Remove rsync; add to removal list] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.4 - Remove avahi; add to removal list] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.5 - Remove snmp; add to removal list] ******************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.6 - Remove squid; add to removal list] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.7 Check is Samba is operational] ***********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.7 Check for log files] *********************************************************************************************************************************************************************************************
[1;35m[WARNING]: Skipped '/var/log/samba/' path due to this access issue: '/var/log/samba/' is not a directory[0m
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.7 Cheking for Samba logs] ******************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite] => {[0m
[0;32m    "smbd_logs.matched": "0"[0m
[0;32m}[0m

TASK [cis_security : 2.2.7 Cheking for Samba service] ***************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite] => {[0m
[0;32m    "smbd_service.status.ActiveState": "inactive"[0m
[0;32m}[0m

TASK [cis_security : 2.2.7 - Remove samba; add to removal list] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.8 - Remove dovecot; add to removal list] ***************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.9 - Remove httpd; add to removal list] *****************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 2.2.10 - Remove vsftpd; add to removal list] ***************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.11 - Remove bind; add to removal list] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.12 - Remove nfs server; add to removal list] ***********************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 2.2.13 - Remove rpcbind; add to removal list] **************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.15 - Disable dhcpd server [controlled by host variable dhcp_server]; add to removal list] **************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.17 - Remove ypserv; add to removal list] ***************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.3.1 - Remove ypbind; add to removal list] ****************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.3.2 - Remove telnet; add to removal list] ****************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.3.3 - Remove openldap-clients; add to removal list] ******************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.3.3 - list of packages to remove] ************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite] => {[0m
[0;32m    "unneeded_packages": [[0m
[0;32m        "rsync",[0m
[0;32m        "avahi",[0m
[0;32m        "net-snmp",[0m
[0;32m        "net-snmp-libs",[0m
[0;32m        "squid",[0m
[0;32m        "samba",[0m
[0;32m        "dovecot",[0m
[0;32m        "vsftpd",[0m
[0;32m        "bind",[0m
[0;32m        "unbound",[0m
[0;32m        "rpcbind",[0m
[0;32m        "dhcp",[0m
[0;32m        "ypserv",[0m
[0;32m        "ypbind",[0m
[0;32m        "telnet",[0m
[0;32m        "openldap-clients"[0m
[0;32m    ][0m
[0;32m}[0m

TASK [cis_security : Process removal list] **************************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 2.2.16 - Disable cups as we my not be able to uninstall it] ************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite] => (item=cups.service) [0m
[0;36mskipping: [dcex1160asmite] => (item=cups.socket) [0m
[0;36mskipping: [dcex1160asmite] => (item=cups-browsed.service) [0m
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 2.2.18 - Find if we have a mail agent config file] *********************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 2.2.18 - If the file exists and not a mail server, then set loopback only] *********************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 3.1 - Set ipv4 networking parameters (OFF)] ****************************************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.conf.all.forwarding)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.conf.all.send_redirects)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.conf.default.send_redirects)[0m

TASK [cis_security : 3.1 - Set ipv6 networking parameters (OFF)] ****************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite] => (item=net.ipv6.conf.all.forwarding) [0m
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 3.2 - Set ipv4 network parameters (OFF)] *******************************************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.conf.all.accept_source_route)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.conf.default.accept_source_route)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.conf.all.accept_redirects)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.conf.default.accept_redirects)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.conf.all.secure_redirects)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.conf.default.secure_redirects)[0m

TASK [cis_security : 3.2.[4-8] - Set ipv4 networking parameters (ON)] ***********************************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.conf.all.log_martians)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.conf.default.log_martians)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.icmp_echo_ignore_broadcasts)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.icmp_ignore_bogus_error_responses)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.conf.all.rp_filter)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.conf.default.rp_filter)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.tcp_syncookies)[0m

TASK [cis_security : 3.2 - Set ipv6 networking parameters (OFF)] ****************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite] => (item=net.ipv6.conf.all.accept_source_route) [0m
[0;36mskipping: [dcex1160asmite] => (item=net.ipv6.conf.default.accept_source_route) [0m
[0;36mskipping: [dcex1160asmite] => (item=net.ipv6.conf.all.accept_redirects) [0m
[0;36mskipping: [dcex1160asmite] => (item=net.ipv6.conf.default.accept_redirects) [0m
[0;36mskipping: [dcex1160asmite] => (item=net.ipv6.conf.all.accept_ra) [0m
[0;36mskipping: [dcex1160asmite] => (item=net.ipv6.conf.default.accept_ra) [0m
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 3.4.1.1 - Install firewalld] *******************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 3.4.2.3 - Disable netfilters service] **********************************************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 3.4.2.4 - Set default zone] ********************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 3.4.4.2 - Configure IPv6 iptables] *************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 4.2.1.1 - Ensure rsyslog is installed] *********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 4.2.1.2 - Enable Rsyslog] **********************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 4.2.1.3 - Ensure rsyslog default file permissions are configured] ******************************************************************************************************************************************************
[0;31m--- before: /etc/rsyslog.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/rsyslog.conf (content)[0m
[0;32m[0m[0;36m@@ -77,3 +77,4 @@[0m
[0;36m[0m # Remote Logging (we use TCP for reliable delivery)
 # remote_host is: name/ip, e.g. 192.168.0.1, port optional e.g. 10514
 #Target="remote_host" Port="XXX" Protocol="tcp")
[0;32m+$FileCreateMode 0640[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : Find any rsyslog files where all logs are being forwarded to a loghost] ************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 4.2.2.1 - Forward journald logs to rsyslog IF rsyslog is sending logs to a log host] ***********************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 4.2.2.2 - Ensure journald compresses large files] **********************************************************************************************************************************************************************
[0;31m--- before: /etc/systemd/journald.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/journald.conf (content)[0m
[0;32m[0m[0;36m@@ -14,6 +14,7 @@[0m
[0;36m[0m [Journal]
 #Storage=auto
 #Compress=yes
[0;32m+Compress=yes[0m
[0;32m[0m #Seal=yes
 #SplitMode=uid
 #SyncIntervalSec=5m

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 4.2.2.3 - Ensure journald writes to peristent disk] ********************************************************************************************************************************************************************
[0;31m--- before: /etc/systemd/journald.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/journald.conf (content)[0m
[0;32m[0m[0;36m@@ -13,6 +13,7 @@[0m
[0;36m[0m 
 [Journal]
 #Storage=auto
[0;32m+Storage=persistent[0m
[0;32m[0m #Compress=yes
 #Seal=yes
 #SplitMode=uid

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 4.2.3 Ensure permissions on all logfiles are configured] ***************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : Create the cron/at allow files (5.1.8)] ********************************************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite] => (item=/etc/cron.allow)[0m
[0;33mchanged: [dcex1160asmite] => (item=/etc/at.allow)[0m

TASK [cis_security : 5.1.1 - Ensure cron is enabled] ****************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.1.2 - Ensure permissions on /etc/crontab] ****************************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0644",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/crontab"
 }

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.1.[3-7] - Ensure permissions on crontab directories] *****************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.hourly"
 }

[0;33mchanged: [dcex1160asmite] => (item=/etc/cron.hourly)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.daily"
 }

[0;33mchanged: [dcex1160asmite] => (item=/etc/cron.daily)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.weekly"
 }

[0;33mchanged: [dcex1160asmite] => (item=/etc/cron.weekly)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.monthly"
 }

[0;33mchanged: [dcex1160asmite] => (item=/etc/cron.monthly)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.d"
 }

[0;33mchanged: [dcex1160asmite] => (item=/etc/cron.d)[0m

TASK [cis_security : 5.2.1 - Set permissions on SSH file] ***********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.2.3 - Find all ssh private host keys] ********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.2.3 - Set permissions on all ssh private host keys (Red Hat set the group to ssh_keys and mode to 640)] **************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0640",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/ssh/ssh_host_rsa_key"
 }

[0;33mchanged: [dcex1160asmite] => (item={'path': '/etc/ssh/ssh_host_rsa_key', 'mode': '0640', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 997, 'size': 1675, 'inode': 25567808, 'dev': 64768, 'nlink': 1, 'atime': 1686047851.3907413, 'mtime': 1644316302.964835, 'ctime': 1644316302.983835, 'gr_name': 'ssh_keys', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': False, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0640",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/ssh/ssh_host_ecdsa_key"
 }

[0;33mchanged: [dcex1160asmite] => (item={'path': '/etc/ssh/ssh_host_ecdsa_key', 'mode': '0640', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 997, 'size': 227, 'inode': 25402743, 'dev': 64768, 'nlink': 1, 'atime': 1686047851.3907413, 'mtime': 1644316303.006835, 'ctime': 1644316303.0108352, 'gr_name': 'ssh_keys', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': False, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0640",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/ssh/ssh_host_ed25519_key"
 }

[0;33mchanged: [dcex1160asmite] => (item={'path': '/etc/ssh/ssh_host_ed25519_key', 'mode': '0640', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 997, 'size': 387, 'inode': 25496133, 'dev': 64768, 'nlink': 1, 'atime': 1686047851.3917413, 'mtime': 1644316303.031835, 'ctime': 1644316303.034835, 'gr_name': 'ssh_keys', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': False, 'xoth': False, 'isuid': False, 'isgid': False})[0m

TASK [cis_security : 5.2.4 - Find all ssh public host keys] *********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.2.4 - Set permissions on all ssh public host keys] *******************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite] => (item={'path': '/etc/ssh/ssh_host_rsa_key.pub', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 382, 'inode': 25182853, 'dev': 64768, 'nlink': 1, 'atime': 1686047851.3907413, 'mtime': 1644316302.9658349, 'ctime': 1644316302.989835, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1160asmite] => (item={'path': '/etc/ssh/ssh_host_ecdsa_key.pub', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 162, 'inode': 25496132, 'dev': 64768, 'nlink': 1, 'atime': 1686047851.3917413, 'mtime': 1644316303.006835, 'ctime': 1644316303.011835, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1160asmite] => (item={'path': '/etc/ssh/ssh_host_ed25519_key.pub', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 82, 'inode': 25496134, 'dev': 64768, 'nlink': 1, 'atime': 1686047851.3917413, 'mtime': 1644316303.031835, 'ctime': 1644316303.0358353, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m

TASK [cis_security : 5.2.5 - Set LogLevel to INFO or more verbose, but not debug] ***********************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.2.7 - Ensure SSH MaxAuthTires is set to 2 or less] *******************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.2.8 - Ensure IgnoreRhosts is set] ************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.2.9 - Ensure HostbasedAuthentication is disabled] ********************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.2.11 - Ensure SSH PermitEmptyPasswords is disabled] ******************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.2.12 - Ensure PermitUserEnvironment is disabled] *********************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.2.13 - Ensure SSH Idle Timeout is configured ClientAliveInterval] ****************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.2.13 - Ensure SSH Idle Timeout is configured ClientAliveCountMax] ****************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -171,3 +171,4 @@[0m
[0;36m[0m # Reject keys that are explicitly blacklisted
 RevokedKeys /etc/ssh/revoked_keys
 
[0;32m+ClientAliveCountMax 0[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.2.14 - Ensure SSH LoginGraceTime is set to 30 or less] ***************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -78,7 +78,7 @@[0m
[0;36m[0m # Secure Login directives.
 UsePrivilegeSeparation sandbox
 
[0;31m-LoginGraceTime 30s[0m
[0;31m[0m[0;32m+LoginGraceTime 30[0m
[0;32m[0m MaxAuthTries 2
 MaxSessions 10
 MaxStartups 10:30:100

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.2.15 - Ensure SSH Banner is configured] ******************************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -171,3 +171,4 @@[0m
[0;36m[0m # Reject keys that are explicitly blacklisted
 RevokedKeys /etc/ssh/revoked_keys
 
[0;32m+Banner /etc/issue[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.2.16 - Ensure SSH is configured to use PAM] **************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.2.17 - Disable TCP Forwarding] ***************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.2.18 - Limit max unauthenticated startups] ***************************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -171,3 +171,4 @@[0m
[0;36m[0m # Reject keys that are explicitly blacklisted
 RevokedKeys /etc/ssh/revoked_keys
 
[0;32m+MaxStartups 10:30:60[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.2.19 - Limit max sessions] *******************************************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -171,3 +171,4 @@[0m
[0;36m[0m # Reject keys that are explicitly blacklisted
 RevokedKeys /etc/ssh/revoked_keys
 
[0;32m+MaxSessions 4[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.4.1 - require at least one digit in passwords] ***********************************************************************************************************************************************************************
[0;31m--- before: /etc/security/pwquality.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/pwquality.conf (content)[0m
[0;32m[0m[0;36m@@ -13,6 +13,7 @@[0m
[0;36m[0m # The maximum credit for having digits in the new password. If less than 0
 # it is the minimum number of digits in the new password.
 # dcredit = 0
[0;32m+dcredit = -1[0m
[0;32m[0m #
 # The maximum credit for having uppercase characters in the new password.
 # If less than 0 it is the minimum number of uppercase characters in the new

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.4.1 - require at least one uppercase letter in passwords] ************************************************************************************************************************************************************
[0;31m--- before: /etc/security/pwquality.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/pwquality.conf (content)[0m
[0;32m[0m[0;36m@@ -18,6 +18,7 @@[0m
[0;36m[0m # If less than 0 it is the minimum number of uppercase characters in the new
 # password.
 # ucredit = 0
[0;32m+ucredit = -1[0m
[0;32m[0m #
 # The maximum credit for having lowercase characters in the new password.
 # If less than 0 it is the minimum number of lowercase characters in the new

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.4.1 - require at least one lowercase letter in passwords] ************************************************************************************************************************************************************
[0;31m--- before: /etc/security/pwquality.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/pwquality.conf (content)[0m
[0;32m[0m[0;36m@@ -23,6 +23,7 @@[0m
[0;36m[0m # If less than 0 it is the minimum number of lowercase characters in the new
 # password.
 # lcredit = 0
[0;32m+lcredit = -1[0m
[0;32m[0m #
 # The maximum credit for having other characters in the new password.
 # If less than 0 it is the minimum number of other characters in the new

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.4.1 - Require at least one special character in passwords] ***********************************************************************************************************************************************************
[0;31m--- before: /etc/security/pwquality.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/pwquality.conf (content)[0m
[0;32m[0m[0;36m@@ -28,6 +28,7 @@[0m
[0;36m[0m # If less than 0 it is the minimum number of other characters in the new
 # password.
 # ocredit = 0
[0;32m+ocredit = -1[0m
[0;32m[0m #
 # The minimum number of required classes of characters for the new
 # password (digits, uppercase, lowercase, others).

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.4.1 - Require at least 14 characters in passwords] *******************************************************************************************************************************************************************
[0;31m--- before: /etc/security/pwquality.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/pwquality.conf (content)[0m
[0;32m[0m[0;36m@@ -9,6 +9,7 @@[0m
[0;36m[0m # credits are not disabled which is the default). (See pam_cracklib manual.)
 # Cannot be set to lower value than 6.
 # minlen = 8
[0;32m+minlen = 14[0m
[0;32m[0m #
 # The maximum credit for having digits in the new password. If less than 0
 # it is the minimum number of digits in the new password.

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.4.3 PAM checks] ******************************************************************************************************************************************************************************************************
[0;31m--- before: /etc/pam.d/system-auth (content)[0m
[0;31m[0m[0;32m+++ after: /etc/pam.d/system-auth (content)[0m
[0;32m[0m[0;36m@@ -13,7 +13,7 @@[0m
[0;36m[0m account     required      pam_permit.so
 
 password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=
[0;31m-password    sufficient    pam_unix.so sha256 shadow nullok try_first_pass use_authtok[0m
[0;31m[0m[0;32m+password    sufficient    pam_unix.so yescrypt shadow nullok use_authtok remember=5 sha512[0m
[0;32m[0m password    required      pam_deny.so
 
 session     optional      pam_keyinit.so revoke

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.4.3 Ensure password reuse is limited | update file according to CIS] *************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.5.1.2 - Ensure password change days is set to 7] *********************************************************************************************************************************************************************
[0;31m--- before: /etc/login.defs (content)[0m
[0;31m[0m[0;32m+++ after: /etc/login.defs (content)[0m
[0;32m[0m[0;36m@@ -23,7 +23,7 @@[0m
[0;36m[0m #	PASS_WARN_AGE	Number of days warning given before a password expires.
 #
 PASS_MAX_DAYS	99999
[0;31m-PASS_MIN_DAYS	0[0m
[0;31m[0m[0;32m+PASS_MIN_DAYS  7[0m
[0;32m[0m PASS_MIN_LEN	5
 PASS_WARN_AGE	7
 

[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.5.1.3 - Ensure password warning days is set to 7] ********************************************************************************************************************************************************************
[0;31m--- before: /etc/login.defs (content)[0m
[0;31m[0m[0;32m+++ after: /etc/login.defs (content)[0m
[0;32m[0m[0;36m@@ -71,3 +71,4 @@[0m
[0;36m[0m ENCRYPT_METHOD SHA256
 
 MD5_CRYPT_ENAB no
[0;32m+PASS_WARN_AGE  7[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite][0m

TASK [cis_security : 5.5.3 - Ensure default shell timeout is 900 seconds or less] ***********************************************************************************************************************************************************
[0;31m--- before: /etc/profile (content)[0m
[0;31m[0m[0;32m+++ after: /etc/profile (content)[0m
[0;32m[0m[0;36m@@ -74,3 +74,4 @@[0m
[0;36m[0m 
 unset i
 unset -f pathmunge
[0;32m+readonly TMOUT=900 ; export TMOUT[0m
[0;32m[0m
[0;33mchanged: [dcex1160asmite] => (item=/etc/profile)[0m

TASK [cis_security : 5.5.4 - Ensure default group for root is GID 0] ************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 5.5.5 - Ensure umask is set] *******************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite] => (item=/etc/bashrc)[0m
[0;32mok: [dcex1160asmite] => (item=/etc/profile)[0m

TASK [cis_security : 5.7 - Configure PAM to only allow su from wheel group] *****************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 5.7 - Add root to the wheel group] *************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 6.1.[2,4] - Ensure permissions on /etc/passwd /etc/group] **************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite] => (item=passwd)[0m
[0;32mok: [dcex1160asmite] => (item=group)[0m

TASK [cis_security : 6.1.[3,5] - Ensure permissions on /etc/shadow /etc/gshadow] ************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite] => (item=shadow)[0m
[0;32mok: [dcex1160asmite] => (item=gshadow)[0m

TASK [cis_security : 6.1.[6-9] - Ensure permissions on /etc/passwd- /etc/[g]shadow- /etc/group-] ********************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0644",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/passwd-"
 }

[0;33mchanged: [dcex1160asmite] => (item=passwd-)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0000",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/shadow-"
 }

[0;33mchanged: [dcex1160asmite] => (item=shadow-)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0644",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/group-"
 }

[0;33mchanged: [dcex1160asmite] => (item=group-)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0000",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/gshadow-"
 }

[0;33mchanged: [dcex1160asmite] => (item=gshadow-)[0m

TASK [cis_security : 6.1.10 - Find any world writiable files] *******************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 6.1.10 - Print any world writable files found] *************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 6.1.11 - Find any unowned files] ***************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 6.1.11 - Print any unowned files found] ********************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 6.1.12 - Find any ungrouped files] *************************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 6.1.12 - Print any ungrouped files found] ******************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 6.2.1 - Check to see if there are any accounts with empty passwords] ***************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 6.2.1 - Report the named users to the report] **************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 6.2.[2,4-5] - Ensure no legacy "+" entries exist in password files] ****************************************************************************************************************************************************
[0;32mok: [dcex1160asmite] => (item=/etc/passwd)[0m
[0;32mok: [dcex1160asmite] => (item=/etc/shadow)[0m
[0;32mok: [dcex1160asmite] => (item=/etc/group)[0m

TASK [cis_security : 6.2.3 - Run script on path variable] ***********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 6.2.3 - Print report to user] ******************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 6.2.6 - find accounts with UID of 0] ***********************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 6.2.6 - Report on mulitple accounts with UID of 0] *********************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 6.2.14 - Use script to pull the list of groups] ************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 6.2.14 - Report to user any unreferenced groups] ***********************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 6.2.15 - Use script to pull the list of duplicate UIDs] ****************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 6.2.15 - Print report of duplicated UIDs to user] **********************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 6.2.16 - Use script to pull the list of duplicate GIDs] ****************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 6.2.16 - Print report of duplcate GIDs to user] ************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 6.2.17 - Use script to pull the list of users] *************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 6.2.17 - Print report of duplicate users to user] **********************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 6.2.18 - Use script to pull the list of groups] ************************************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 6.2.18 - Print report of duplicate groups to user] *********************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 6.2.19 - Determine if the shadow group exists in /etc/group] ***********************************************************************************************************************************************************
[0;32mok: [dcex1160asmite][0m

TASK [cis_security : 6.2.19 - Print report of shadow group to user] *************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 6.2.20 - Use script to find the users] *********************************************************************************************************************************************************************************
[0;36mskipping: [dcex1160asmite][0m

TASK [cis_security : 6.2.20 - Print report of users that do not have a home directory] ******************************************************************************************************************************************************
[0;31mfatal: [dcex1160asmite]: FAILED! => {"msg": "The conditional check 'nohomedir.stdout' failed. The error was: error while evaluating conditional (nohomedir.stdout): 'dict object' has no attribute 'stdout'. 'dict object' has no attribute 'stdout'\n\nThe error appears to be in '/home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/redhat-8-type.yml': line 1928, column 9, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n      - name: 6.2.20 - Print report of users that do not have a home directory\n        ^ here\n"}[0m
[0;36m...ignoring[0m

TASK [cis_security : Add hardening file.] ***************************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite][0m

RUNNING HANDLER [cis_security : restart sshd] ***********************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite][0m

RUNNING HANDLER [cis_security : restart chronyd] ********************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite][0m

RUNNING HANDLER [cis_security : restart tmpfs] **********************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite][0m

RUNNING HANDLER [cis_security : flush network routes] ***************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1160asmite] => (item=net.ipv4.route.flush)[0m
[0;33mchanged: [dcex1160asmite] => (item=net.ipv6.route.flush)[0m

PLAY RECAP **********************************************************************************************************************************************************************************************************************************
[0;33mdcex1160asmite[0m             : [0;32mok=143 [0m [0;33mchanged=51  [0m unreachable=0    failed=0    [0;36mskipped=39  [0m rescued=0    [1;35mignored=2   [0m


Script done on 2023-06-07 12:18:18+02:00
