Script started on 2023-06-01 11:17:31+02:00
[1;35m[WARNING]: While constructing a mapping from /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/defaults/main.yml, line 6, column 1, found a duplicate dict key (enable_firewall). Using last defined value only.[0m
[1;35m[WARNING]: While constructing a mapping from /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/defaults/main.yml, line 6, column 1, found a duplicate dict key (ssh_max_sessions). Using last defined value only.[0m
[0;35m[DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. See https://docs.ansible.com/ansible-core/2.14/user_guide/playbooks_reuse_includes.html for details. This feature will be removed in version 2.16. [0m
[0;35mDeprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.[0m

PLAY [all] **********************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] **********************************************************************************************************************************************************************************************************************
[1;35m[WARNING]: Platform linux on host dcex1441pjv1hw9 is using the discovered Python interpreter at /usr/bin/python3.6, but future installation of another Python interpreter could change the meaning of that path. See[0m
[1;35mhttps://docs.ansible.com/ansible-core/2.14/reference_appendices/interpreter_discovery.html for more information.[0m
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : include] ***************************************************************************************************************************************************************************************************************
[0;35m[DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks/import_playbook instead. This feature will be removed in version 2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in [0m
[0;35mansible.cfg.[0m
[0;36mincluded: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/CIS-OracleLinux-8.yml for dcex1441pjv1hw9[0m

TASK [cis_security : include] ***************************************************************************************************************************************************************************************************************
[1;35m[WARNING]: While constructing a mapping from /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/oracle-8-type.yml, line 906, column 5, found a duplicate dict key (tags). Using last defined value only.[0m
[0;36mincluded: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/oracle-8-type.yml for dcex1441pjv1hw9[0m

TASK [cis_security : Print Header] **********************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => {[0m
[0;32m    "msg": "CIS Controls for OracleLinux 8"[0m
[0;32m}[0m

TASK [cis_security : Collect package list] **************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.1.1.1 Ensure mounting of cramfs filesystems is disabled] *************************************************************************************************************************************************************
[0;31m--- before: /etc/modprobe.d/cramfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/cramfs.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install cramfs /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item={'From': '(?m)^\\S+\\s+install cramfs', 'To': 'install cramfs /bin/true'})[0m
[0;31m--- before: /etc/modprobe.d/cramfs.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/cramfs.conf (content)[0m
[0;32m[0m[0;36m@@ -1 +1,2 @@[0m
[0;36m[0m install cramfs /bin/true
[0;32m+blacklist cramfs[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item={'From': '(?m)^\\S+\\s+blacklist cramfs', 'To': 'blacklist cramfs'})[0m

TASK [cis_security : 1.1.1.1 Ensure mounting of cramfs filesystems is disabled | modprobe] **************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : Get file system] *******************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : debug] *****************************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => {[0m
[0;32m    "filesystem.stdout": "xfs"[0m
[0;32m}[0m

TASK [cis_security : Check /tmp config] *****************************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : Remount /tmp] **********************************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : Get file system] *******************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : debug] *****************************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => {[0m
[0;32m    "varsystem.stdout": "xfs"[0m
[0;32m}[0m

TASK [cis_security : Check /var config] *****************************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : Remount /var] **********************************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.1.4 Ensure nodev option set on /var/tmp partitions] ******************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : /var/tmp partitions] ***************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => {[0m
[0;32m    "msg": {[0m
[0;32m        "changed": false,[0m
[0;32m        "cmd": "mount | grep \"on /var\" && true || true\n",[0m
[0;32m        "delta": "0:00:00.007076",[0m
[0;32m        "end": "2023-06-01 11:17:46.629215",[0m
[0;32m        "failed": false,[0m
[0;32m        "msg": "",[0m
[0;32m        "rc": 0,[0m
[0;32m        "start": "2023-06-01 11:17:46.622139",[0m
[0;32m        "stderr": "",[0m
[0;32m        "stderr_lines": [],[0m
[0;32m        "stdout": "/dev/mapper/system-var on /var type xfs (rw,nosuid,nodev,relatime,attr2,inode64,logbufs=8,logbsize=32k,noquota)\n/dev/mapper/elasticsearch-elasticsearch1 on /var/lib/elasticsearch1 type ext4 (rw,relatime)\n/dev/mapper/system-log on /var/log type xfs (rw,nodev,relatime,attr2,inode64,logbufs=8,logbsize=32k,noquota)\n/dev/mapper/system-audit on /var/log/audit type xfs (rw,nodev,relatime,attr2,inode64,logbufs=8,logbsize=32k,noquota)\nsunrpc on /var/lib/nfs/rpc_pipefs type rpc_pipefs (rw,relatime)",[0m
[0;32m        "stdout_lines": [[0m
[0;32m            "/dev/mapper/system-var on /var type xfs (rw,nosuid,nodev,relatime,attr2,inode64,logbufs=8,logbsize=32k,noquota)",[0m
[0;32m            "/dev/mapper/elasticsearch-elasticsearch1 on /var/lib/elasticsearch1 type ext4 (rw,relatime)",[0m
[0;32m            "/dev/mapper/system-log on /var/log type xfs (rw,nodev,relatime,attr2,inode64,logbufs=8,logbsize=32k,noquota)",[0m
[0;32m            "/dev/mapper/system-audit on /var/log/audit type xfs (rw,nodev,relatime,attr2,inode64,logbufs=8,logbsize=32k,noquota)",[0m
[0;32m            "sunrpc on /var/lib/nfs/rpc_pipefs type rpc_pipefs (rw,relatime)"[0m
[0;32m        ][0m
[0;32m    }[0m
[0;32m}[0m

TASK [cis_security : Get file system] *******************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : debug] *****************************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => {[0m
[0;32m    "varlogsystem.stdout": "xfs"[0m
[0;32m}[0m

TASK [cis_security : Check /var/log config] *************************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : Remount /var/log] ******************************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : Get file system] *******************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : debug] *****************************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => {[0m
[0;32m    "varauditsystem.stdout": "xfs"[0m
[0;32m}[0m

TASK [cis_security : Check /var/log/audit config] *******************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : Remount /var/log/audit] ************************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : Get file system] *******************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : debug] *****************************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => {[0m
[0;32m    "homesystem.stdout": "xfs"[0m
[0;32m}[0m

TASK [cis_security : Check /home config] ****************************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : Remount /home] *********************************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security :  Ensure /dev/shm is configured
 1.1.8.1 Ensure nodev option set on /dev/shm partition
 1.1.8.2 Ensure nosuid option set on /dev/shm partition
 1.1.8.3 Ensure noexec option set on /dev/shm partition] ********************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.1.9 - disable automounting] ******************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.1.23 - Disable USB storage module] ***********************************************************************************************************************************************************************************
[0;31m--- before: /etc/modprobe.d/CIS.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/CIS.conf (content)[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+install usb-storage /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.2.2 - set master yum.conf gpgcheck to '1'] ***************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.2.2 - set master dnf.conf gpgcheck to '1'] ***************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.2.2 - find all repo files in /etc/yum.repos.d/] **********************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.2.2 - Set all repos gpgchecks to '1'] ********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/yum.repos.d/oracle-linux-ol8.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 3660, 'inode': 51246497, 'dev': 64768, 'nlink': 1, 'atime': 1685562030.6069946, 'mtime': 1680619871.9620125, 'ctime': 1680619871.9620125, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/yum.repos.d/uek-ol8.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 941, 'inode': 51246498, 'dev': 64768, 'nlink': 1, 'atime': 1685562033.0550218, 'mtime': 1680619871.6130064, 'ctime': 1680619871.6130064, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/yum.repos.d/virt-ol8.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 243, 'inode': 51246499, 'dev': 64768, 'nlink': 1, 'atime': 1685562033.0580218, 'mtime': 1668044583.0, 'ctime': 1680619662.2499835, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/yum.repos.d/epel-modular.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 1698, 'inode': 51100327, 'dev': 64768, 'nlink': 1, 'atime': 1685562029.1429782, 'mtime': 1664839569.0, 'ctime': 1680620366.9024456, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/yum.repos.d/epel-testing-modular.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 1797, 'inode': 51100328, 'dev': 64768, 'nlink': 1, 'atime': 1685562029.1439784, 'mtime': 1664839569.0, 'ctime': 1680620366.9024456, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/yum.repos.d/epel-testing.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 1431, 'inode': 51100329, 'dev': 64768, 'nlink': 1, 'atime': 1685562029.1449783, 'mtime': 1664839569.0, 'ctime': 1680620366.9034455, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/yum.repos.d/epel.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 1332, 'inode': 51100330, 'dev': 64768, 'nlink': 1, 'atime': 1685562029.1439784, 'mtime': 1664839569.0, 'ctime': 1680620366.9034455, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/yum.repos.d/ICINGA-release.repo', 'mode': '0640', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 182, 'inode': 51100331, 'dev': 64768, 'nlink': 1, 'atime': 1685543540.6194782, 'mtime': 1644588976.0, 'ctime': 1680859127.7834437, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': False, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/yum.repos.d/ICINGA-snapshot.repo', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 217, 'inode': 51100333, 'dev': 64768, 'nlink': 1, 'atime': 1685537786.1744008, 'mtime': 1574179747.0, 'ctime': 1680681762.6031427, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m

TASK [cis_security : 1.3.1 Ensure aide is installed] ****************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.3.1 - Determine if AIDE has already been initialized] ****************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.3.1 - Set up database file location] *********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.3.1 - Set up database_out file location] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.3.1 - enable gzip compression for database] **************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.3.1 - Move the newly created database into place] ********************************************************************************************************************************************************************
[0;31mfatal: [dcex1441pjv1hw9]: FAILED! => {"changed": false, "msg": "Source /var/lib/aide/aide.db.new.gz not found"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 1.5.2 - Ensure IgnoreRhosts is set] ************************************************************************************************************************************************************************************
[0;31m--- before: /etc/systemd/coredump.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/coredump.conf (content)[0m
[0;32m[0m[0;36m@@ -19,3 +19,4 @@[0m
[0;36m[0m #JournalSizeMax=767M
 #MaxUse=
 #KeepFree=
[0;32m+ProcessSizeMax=0[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.5.3 - Ensure address space layout reandomization (ASLR) is enabled] **************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.6.1.1 - Ensure SELinux is installed] *********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : Regather facts] ********************************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.6.1.2 - Ensure SELinux is not disabled in bootloader configuration] **************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => (item=selinux=0)[0m
[0;32mok: [dcex1441pjv1hw9] => (item=enforcing=0)[0m

TASK [cis_security : 1.6.1.6 - Generate report on unconfined running services] **************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.6.1.6 - Report on unconfined running services to user] ***************************************************************************************************************************************************************
[0;31mfatal: [dcex1441pjv1hw9]: FAILED! => {"msg": "The conditional check 'unconfined_services_out.stdout' failed. The error was: error while evaluating conditional (unconfined_services_out.stdout): 'dict object' has no attribute 'stdout'. 'dict object' has no attribute 'stdout'\n\nThe error appears to be in '/home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/oracle-8-type.yml': line 548, column 9, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n      # Print any findings to the user\n      - name: 1.6.1.6 - Report on unconfined running services to user\n        ^ here\n"}[0m
[0;36m...ignoring[0m

TASK [cis_security : 1.6.1.7 - Remove setroubleshoot] ***************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.6.1.8 - Remove MCS Translation Service] ******************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.7.1 - Install motd banners] ******************************************************************************************************************************************************************************************
[0;31m--- before: /etc/motd[0m
[0;31m[0m[0;32m+++ after: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/files/banner[0m
[0;32m[0m[0;36m@@ -0,0 +1,6 @@[0m
[0;36m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.7.2 - Install issue banners] *****************************************************************************************************************************************************************************************
[0;31m--- before: /etc/issue[0m
[0;31m[0m[0;32m+++ after: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/files/issue[0m
[0;32m[0m[0;36m@@ -1,3 +1,6 @@[0m
[0;36m[0m[0;31m-\S[0m
[0;31m[0m[0;31m-Kernel \r on an \m[0m
[0;31m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m 

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.8.1.3 - Install issue.net banners] ***********************************************************************************************************************************************************************************
[0;31m--- before: /etc/issue.net[0m
[0;31m[0m[0;32m+++ after: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/files/issue[0m
[0;32m[0m[0;36m@@ -1,2 +1,6 @@[0m
[0;36m[0m[0;31m-\S[0m
[0;31m[0m[0;31m-Kernel \r on an \m[0m
[0;31m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.8.2 Ensure GDM banner set up] ****************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.10.0 - Display error if crypto variable violates policy] *************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.10.0 - Set crypto-policy to DEFAULT] *********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.10.0 - Check to see if FIPS mode is already set up if crypto_policy == "FIPS"] ***************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 1.10.0 - Enabling FIPS mode if crypt_policy set to FIPS] ***************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.1.1 - Verify chrony is  installed] ***********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.1.2 - Configure chrony] **********************************************************************************************************************************************************************************************
[0;31m--- before: /etc/chrony.conf[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-641482lzsduu2b/tmpnivekmdy/chrony.conf[0m
[0;32m[0m[0;36m@@ -1,4 +1,5 @@[0m
[0;36m[0m[0;31m-[0m
[0;31m[0m[0;32m+# Use public servers from the pool.ntp.org project.[0m
[0;32m[0m[0;32m+# Please consider joining the pool (http://www.pool.ntp.org/join.html).[0m
[0;32m[0m server uxtime1.gfk.de iburst
 server uxtime2.gfk.de iburst
 
[0;36m@@ -26,11 +27,13 @@[0m
[0;36m[0m #local stratum 10
 
 # Specify file containing keys for NTP authentication.
[0;31m-#keyfile /etc/chrony.keys[0m
[0;31m[0m[0;32m+keyfile /etc/chrony.keys[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m[0;32m+# Get TAI-UTC offset and leap seconds from the system tz database.[0m
[0;32m[0m[0;32m+leapsectz right/UTC[0m
[0;32m[0m 
 # Specify directory for log files.
 logdir /var/log/chrony
 
 # Select which information is logged.
 #log measurements statistics tracking
[0;31m-[0m
[0;31m[0m
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.1.3 - configure sysconfig time_server options] ***********************************************************************************************************************************************************************
[0;31m--- before: /etc/sysconfig/chronyd[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-641482lzsduu2b/tmp2n1csqk2/chronyd[0m
[0;32m[0m[0;36m@@ -1,2 +1 @@[0m
[0;36m[0m[0;31m-# Command-line options for chronyd[0m
[0;31m[0m[0;31m-OPTIONS=""[0m
[0;31m[0m[0;32m+OPTIONS="-u chrony"[0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : create empty list for unneeded packages] *******************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.1 - Remove xinetd service] *****************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.2 - Ensure xorg-x11-server-common is not installed] ****************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.3 - Remove avahi; add to removal list] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.4 - Disable dhcpd server [controlled by host variable dhcp_server]; add to removal list] ***************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.5 - Disable dhcpd server [controlled by host variable dhcp_server]; add to removal list] ***************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.6 - Remove bind; add to removal list] ******************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.7 - Remove ftp; add to removal list] *******************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.8 - Remove vsftpd; add to removal list] ****************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.9 - Remove tftp; add to removal list] ******************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.10 - Remove httpd; add to removal list] ****************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.11 - Remove dovecot; add to removal list] **************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.12 - Remove samba; add to removal list] ****************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.13 - Remove squid; add to removal list] ****************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.14 - Remove snmp; add to removal list] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.15 - Remove ypserv; add to removal list] ***************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.16 - Remove telnet; add to removal list] ***************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.18 - Remove nfs server; add to removal list] ***********************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.19 - Remove rpcbind; add to removal list] **************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.20 - Remove rsync; add to removal list] ****************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.3.1 - Remove ypbind; add to removal list] ****************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.3.2 - Remove rsh; add to removal list] *******************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.3.3 - Ensure talk client is not installed] ***************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.3.5 - Remove openldap-clients; add to removal list] ******************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.[2-3] - list of packages to remove] **********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => {[0m
[0;32m    "unneeded_packages": [[0m
[0;32m        "xinetd",[0m
[0;32m        "avahi",[0m
[0;32m        "avahi-autoipd",[0m
[0;32m        "cups",[0m
[0;32m        "dhcp-server",[0m
[0;32m        "bind",[0m
[0;32m        "unbound",[0m
[0;32m        "ftp",[0m
[0;32m        "vsftpd",[0m
[0;32m        "tftp-server",[0m
[0;32m        "tftp",[0m
[0;32m        "httpd",[0m
[0;32m        "dovecot",[0m
[0;32m        "cyrus-imapd",[0m
[0;32m        "samba",[0m
[0;32m        "squid",[0m
[0;32m        "net-snmp",[0m
[0;32m        "ypserv",[0m
[0;32m        "telnet",[0m
[0;32m        "nfs-utils",[0m
[0;32m        "rpcbind",[0m
[0;32m        "rsync",[0m
[0;32m        "ypbind",[0m
[0;32m        "rsh",[0m
[0;32m        "talk",[0m
[0;32m        "openldap-clients"[0m
[0;32m    ][0m
[0;32m}[0m

TASK [cis_security : Process removal list] **************************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.17 - Find if we have a mail agent config file] *********************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 2.2.17 - If the file exists and not a mail server, then set loopback only] *********************************************************************************************************************************************
[0;31m--- before: /etc/postfix/main.cf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/postfix/main.cf (content)[0m
[0;32m[0m[0;36m@@ -113,7 +113,7 @@[0m
[0;36m[0m #inet_interfaces = all
 #inet_interfaces = $myhostname
 #inet_interfaces = $myhostname, localhost
[0;31m-inet_interfaces = localhost[0m
[0;31m[0m[0;32m+inet_interfaces = loopback-only[0m
[0;32m[0m 
 # Enable IPv4, and IPv6 if supported
 inet_protocols = all

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 3.1 - Set ipv4 networking parameters (OFF)] ****************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.conf.all.forwarding)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.conf.all.send_redirects)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.conf.default.send_redirects)[0m

TASK [cis_security : 3.1 - Set ipv6 networking parameters (OFF)] ****************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9] => (item=net.ipv6.conf.all.forwarding) [0m
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 3.2 - Set ipv4 network parameters (OFF)] *******************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.conf.all.accept_source_route)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.conf.default.accept_source_route)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.conf.all.accept_redirects)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.conf.default.accept_redirects)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.conf.all.secure_redirects)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.conf.default.secure_redirects)[0m

TASK [cis_security : 3.2.[4-8] - Set ipv4 networking parameters (ON)] ***********************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.conf.all.log_martians)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.conf.default.log_martians)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.icmp_echo_ignore_broadcasts)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.icmp_ignore_bogus_error_responses)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.conf.all.rp_filter)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.conf.default.rp_filter)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.tcp_syncookies)[0m

TASK [cis_security : 3.2 - Set ipv6 networking parameters (OFF)] ****************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9] => (item=net.ipv6.conf.all.accept_source_route) [0m
[0;36mskipping: [dcex1441pjv1hw9] => (item=net.ipv6.conf.default.accept_source_route) [0m
[0;36mskipping: [dcex1441pjv1hw9] => (item=net.ipv6.conf.all.accept_redirects) [0m
[0;36mskipping: [dcex1441pjv1hw9] => (item=net.ipv6.conf.default.accept_redirects) [0m
[0;36mskipping: [dcex1441pjv1hw9] => (item=net.ipv6.conf.all.accept_ra) [0m
[0;36mskipping: [dcex1441pjv1hw9] => (item=net.ipv6.conf.default.accept_ra) [0m
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 3.4.1.1 - Install firewalld] *******************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 3.4.2.2 - Disable iptables service] ************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 3.4.2.3 - Disable netfilters service] **********************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 3.4.1.5 - Set default zone] ********************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : Notify users to configure the firewall] ********************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 3.6 - Find if IPv6 is currently in the grub file, shows changed when it is in the file] ********************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 3.6 - Disable IPv6 in grub] ********************************************************************************************************************************************************************************************
[0;31m--- before: /etc/default/grub[0m
[0;31m[0m[0;32m+++ after: /etc/default/grub[0m
[0;32m[0m[0;36m@@ -4,5 +4,5 @@[0m
[0;36m[0m GRUB_DEFAULT=saved
 GRUB_DISABLE_SUBMENU=true
 GRUB_TERMINAL_OUTPUT="console"
[0;31m-GRUB_CMDLINE_LINUX="nofb splash=quiet options crashkernel=auto rd.lvm.lv=system/root rd.lvm.lv=system/swap nomodeset biosdevname=0 net.ifnames=0 rhgb quiet"[0m
[0;31m[0m[0;32m+GRUB_CMDLINE_LINUX="ipv6.disable=1 nofb splash=quiet options crashkernel=auto rd.lvm.lv=system/root rd.lvm.lv=system/swap nomodeset biosdevname=0 net.ifnames=0 rhgb quiet"[0m
[0;32m[0m GRUB_DISABLE_RECOVERY="true"

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 4.2.1.1 - Ensure rsyslog is installed] *********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 4.2.1.2 - Enable Rsyslog] **********************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 4.2.1.3 - Ensure rsyslog default file permissions are configured] ******************************************************************************************************************************************************
[0;31m--- before: /etc/rsyslog.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/rsyslog.conf (content)[0m
[0;32m[0m[0;36m@@ -77,3 +77,4 @@[0m
[0;36m[0m # Remote Logging (we use TCP for reliable delivery)
 # remote_host is: name/ip, e.g. 192.168.0.1, port optional e.g. 10514
 #Target="remote_host" Port="XXX" Protocol="tcp")
[0;32m+$FileCreateMode 0640[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : Find any rsyslog files where all logs are being forwarded to a loghost] ************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 4.2.2.1 - Forward journald logs to rsyslog IF rsyslog is sending logs to a log host] ***********************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 4.2.2.2 - Ensure journald compresses large files] **********************************************************************************************************************************************************************
[0;31m--- before: /etc/systemd/journald.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/journald.conf (content)[0m
[0;32m[0m[0;36m@@ -14,6 +14,7 @@[0m
[0;36m[0m [Journal]
 #Storage=auto
 #Compress=yes
[0;32m+Compress=yes[0m
[0;32m[0m #Seal=yes
 #SplitMode=uid
 #SyncIntervalSec=5m

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 4.2.2.3 - Ensure journald writes to peristent disk] ********************************************************************************************************************************************************************
[0;31m--- before: /etc/systemd/journald.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/journald.conf (content)[0m
[0;32m[0m[0;36m@@ -13,6 +13,7 @@[0m
[0;36m[0m 
 [Journal]
 #Storage=auto
[0;32m+Storage=persistent[0m
[0;32m[0m #Compress=yes
 Compress=yes
 #Seal=yes

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 4.2.3 Ensure permissions on all logfiles are configured] ***************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : Remove /etc/cron.deny] *************************************************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/etc/cron.deny",
[0;31m-    "state": "file"[0m
[0;31m[0m[0;32m+    "state": "absent"[0m
[0;32m[0m }

[0;33mchanged: [dcex1441pjv1hw9] => (item=/etc/cron.deny)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/etc/at.deny",
[0;31m-    "state": "file"[0m
[0;31m[0m[0;32m+    "state": "absent"[0m
[0;32m[0m }

[0;33mchanged: [dcex1441pjv1hw9] => (item=/etc/at.deny)[0m

TASK [cis_security : Create the cron/at allow files (5.1.8)] ********************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9] => (item=/etc/cron.allow)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=/etc/at.allow)[0m

TASK [cis_security : 5.1.1 - Ensure cron is enabled] ****************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.1.2 - Ensure permissions on /etc/crontab] ****************************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0644",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/crontab"
 }

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.1.[3-7] - Ensure permissions on crontab directories] *****************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.hourly"
 }

[0;33mchanged: [dcex1441pjv1hw9] => (item=/etc/cron.hourly)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.daily"
 }

[0;33mchanged: [dcex1441pjv1hw9] => (item=/etc/cron.daily)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.weekly"
 }

[0;33mchanged: [dcex1441pjv1hw9] => (item=/etc/cron.weekly)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.monthly"
 }

[0;33mchanged: [dcex1441pjv1hw9] => (item=/etc/cron.monthly)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.d"
 }

[0;33mchanged: [dcex1441pjv1hw9] => (item=/etc/cron.d)[0m

TASK [cis_security : 5.2.1 - Set permissions on SSH file] ***********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.3 - Find all ssh private host keys] ********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.3 - Set permissions on all ssh private host keys (Red Hat set the group to ssh_keys and mode to 640)] **************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/ssh/ssh_host_rsa_key', 'mode': '0640', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 997, 'size': 1679, 'inode': 50457312, 'dev': 64768, 'nlink': 1, 'atime': 1685563764.1432009, 'mtime': 1667921000.920789, 'ctime': 1667921000.9337893, 'gr_name': 'ssh_keys', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': False, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/ssh/ssh_host_ecdsa_key', 'mode': '0640', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 997, 'size': 227, 'inode': 51311405, 'dev': 64768, 'nlink': 1, 'atime': 1685563764.145201, 'mtime': 1667921000.9507895, 'ctime': 1667921000.9547896, 'gr_name': 'ssh_keys', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': False, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/ssh/ssh_host_ed25519_key', 'mode': '0640', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 997, 'size': 387, 'inode': 51409536, 'dev': 64768, 'nlink': 1, 'atime': 1685563764.148201, 'mtime': 1667921000.9677896, 'ctime': 1667921000.97079, 'gr_name': 'ssh_keys', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': False, 'xoth': False, 'isuid': False, 'isgid': False})[0m

TASK [cis_security : 5.2.4 - Find all ssh public host keys] *********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.4 - Set permissions on all ssh public host keys] *******************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/ssh/ssh_host_rsa_key.pub', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 382, 'inode': 51099893, 'dev': 64768, 'nlink': 1, 'atime': 1685563764.145201, 'mtime': 1667921000.923789, 'ctime': 1667921000.9347892, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/ssh/ssh_host_ecdsa_key.pub', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 162, 'inode': 51409535, 'dev': 64768, 'nlink': 1, 'atime': 1685563764.147201, 'mtime': 1667921000.9527895, 'ctime': 1667921000.9557896, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m
[0;32mok: [dcex1441pjv1hw9] => (item={'path': '/etc/ssh/ssh_host_ed25519_key.pub', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 0, 'gid': 0, 'size': 82, 'inode': 51409651, 'dev': 64768, 'nlink': 1, 'atime': 1685563764.1492012, 'mtime': 1667921000.9677896, 'ctime': 1667921000.9717898, 'gr_name': 'root', 'pw_name': 'root', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False})[0m

TASK [cis_security : 5.2.5 - Set LogLevel to INFO or more verbose, but not debug] ***********************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.6 - Ensure SSH is configured to use PAM] ***************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.8 - Ensure HostbasedAuthentication is disabled] ********************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.9 - Ensure SSH PermitEmptyPasswords is disabled] *******************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -100,7 +100,6 @@[0m
[0;36m[0m 
 # Disable password-based authentication, it can allow for potentially easier brute-force attacks.
 PasswordAuthentication no
[0;31m-PermitEmptyPasswords no[0m
[0;31m[0m ChallengeResponseAuthentication no
 
 # Only enable Kerberos authentication if it is configured.

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.10 - Ensure PermitUserEnvironment is disabled] *********************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -150,7 +150,6 @@[0m
[0;36m[0m # User environment configuration
 # ==============================
 
[0;31m-PermitUserEnvironment no[0m
[0;31m[0m 
 
 # Misc. configuration

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.11 - Ensure IgnoreRhosts is set] ***********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.15 - Ensure SSH Banner is configured] ******************************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -169,3 +169,4 @@[0m
[0;36m[0m # Reject keys that are explicitly blacklisted
 RevokedKeys /etc/ssh/revoked_keys
 
[0;32m+Banner /etc/issue[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.16 - Ensure SSH MaxAuthTires is set to 2 or less] ******************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.17 - Limit max unauthenticated startups] ***************************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -81,7 +81,7 @@[0m
[0;36m[0m LoginGraceTime 30s
 MaxAuthTries 2
 MaxSessions 10
[0;31m-MaxStartups 10:30:100[0m
[0;31m[0m[0;32m+MaxStartups 10:30:60[0m
[0;32m[0m 
 # Enable public key authentication
 PubkeyAuthentication yes

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.18 - Limit max sessions] *******************************************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -80,7 +80,7 @@[0m
[0;36m[0m 
 LoginGraceTime 30s
 MaxAuthTries 2
[0;31m-MaxSessions 10[0m
[0;31m[0m[0;32m+MaxSessions 4[0m
[0;32m[0m MaxStartups 10:30:60
 
 # Enable public key authentication

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.19 - Ensure SSH LoginGraceTime is set to 30 or less] ***************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -78,7 +78,7 @@[0m
[0;36m[0m # Secure Login directives.
 UsePrivilegeSeparation sandbox
 
[0;31m-LoginGraceTime 30s[0m
[0;31m[0m[0;32m+LoginGraceTime 30[0m
[0;32m[0m MaxAuthTries 2
 MaxSessions 4
 MaxStartups 10:30:60

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.20 - Ensure SSH Idle Timeout is configured ClientAliveInterval] ****************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.2.20 - Ensure SSH Idle Timeout is configured ClientAliveCountMax] ****************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -127,7 +127,7 @@[0m
[0;36m[0m 
 # Manage `ClientAlive..` signals via interval and maximum count. This will periodically check up to a `..CountMax` number of times within `..Interval` timeframe, and abort the connection once these fail.
 ClientAliveInterval 300
[0;31m-ClientAliveCountMax 3[0m
[0;31m[0m[0;32m+ClientAliveCountMax 0[0m
[0;32m[0m 
 # Disable tunneling
 PermitTunnel no

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.3.1 - Ensure sudo is installed] **************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.3.2 - Ensure sudo commands use pty] **********************************************************************************************************************************************************************************
[0;31m--- before: /etc/sudoers (content)[0m
[0;31m[0m[0;32m+++ after: /etc/sudoers (content)[0m
[0;32m[0m[0;36m@@ -48,6 +48,7 @@[0m
[0;36m[0m # Cmnd_Alias DRIVERS = /sbin/modprobe
 
 # Defaults specification
[0;32m+Defaults use_pty[0m
[0;32m[0m 
 #
 # Refuse to run if unable to disable echo on the tty.

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.3.3 - Ensure sudo log file exists] ***********************************************************************************************************************************************************************************
[0;31m--- before: /etc/sudoers (content)[0m
[0;31m[0m[0;32m+++ after: /etc/sudoers (content)[0m
[0;32m[0m[0;36m@@ -48,6 +48,7 @@[0m
[0;36m[0m # Cmnd_Alias DRIVERS = /sbin/modprobe
 
 # Defaults specification
[0;32m+Defaults logfile="/var/log/sudoers"[0m
[0;32m[0m Defaults use_pty
 
 #

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.5.1 - require at least one digit in passwords] ***********************************************************************************************************************************************************************
[0;31m--- before: /etc/security/pwquality.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/pwquality.conf (content)[0m
[0;32m[0m[0;36m@@ -13,6 +13,7 @@[0m
[0;36m[0m # The maximum credit for having digits in the new password. If less than 0
 # it is the minimum number of digits in the new password.
 # dcredit = 0
[0;32m+dcredit = -1[0m
[0;32m[0m #
 # The maximum credit for having uppercase characters in the new password.
 # If less than 0 it is the minimum number of uppercase characters in the new

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.5.1 - require at least one uppercase letter in passwords] ************************************************************************************************************************************************************
[0;31m--- before: /etc/security/pwquality.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/pwquality.conf (content)[0m
[0;32m[0m[0;36m@@ -19,6 +19,7 @@[0m
[0;36m[0m # If less than 0 it is the minimum number of uppercase characters in the new
 # password.
 # ucredit = 0
[0;32m+ucredit = -1[0m
[0;32m[0m #
 # The maximum credit for having lowercase characters in the new password.
 # If less than 0 it is the minimum number of lowercase characters in the new

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.5.1 - require at least one lowercase letter in passwords] ************************************************************************************************************************************************************
[0;31m--- before: /etc/security/pwquality.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/pwquality.conf (content)[0m
[0;32m[0m[0;36m@@ -25,6 +25,7 @@[0m
[0;36m[0m # If less than 0 it is the minimum number of lowercase characters in the new
 # password.
 # lcredit = 0
[0;32m+lcredit = -1[0m
[0;32m[0m #
 # The maximum credit for having other characters in the new password.
 # If less than 0 it is the minimum number of other characters in the new

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.5.1 - Require at least one special character in passwords] ***********************************************************************************************************************************************************
[0;31m--- before: /etc/security/pwquality.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/pwquality.conf (content)[0m
[0;32m[0m[0;36m@@ -31,6 +31,7 @@[0m
[0;36m[0m # If less than 0 it is the minimum number of other characters in the new
 # password.
 # ocredit = 0
[0;32m+ocredit = -1[0m
[0;32m[0m #
 # The minimum number of required classes of characters for the new
 # password (digits, uppercase, lowercase, others).

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.5.1 - Require at least 14 characters in passwords] *******************************************************************************************************************************************************************
[0;31m--- before: /etc/security/pwquality.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/pwquality.conf (content)[0m
[0;32m[0m[0;36m@@ -9,6 +9,7 @@[0m
[0;36m[0m # credits are not disabled which is the default). (See pam_cracklib manual.)
 # Cannot be set to lower value than 6.
 # minlen = 8
[0;32m+minlen = 14[0m
[0;32m[0m #
 # The maximum credit for having digits in the new password. If less than 0
 # it is the minimum number of digits in the new password.

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : add deny] **************************************************************************************************************************************************************************************************************
[0;31m--- before: /etc/security/faillock.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/faillock.conf (content)[0m
[0;32m[0m[0;36m@@ -60,3 +60,4 @@[0m
[0;36m[0m # `root_unlock_time` will apply to them.
 # By default, the option is not set.
 # admin_group = <admin_group_name>
[0;32m+deny = 5[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.5.2 add unlock_time] *************************************************************************************************************************************************************************************************
[0;31m--- before: /etc/security/faillock.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/faillock.conf (content)[0m
[0;32m[0m[0;36m@@ -61,3 +61,4 @@[0m
[0;36m[0m # By default, the option is not set.
 # admin_group = <admin_group_name>
 deny = 5
[0;32m+unlock_time = 900[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.5.3/5.5.4 PAM checks] ************************************************************************************************************************************************************************************************
[0;31m--- before: /etc/pam.d/system-auth (content)[0m
[0;31m[0m[0;32m+++ after: /etc/pam.d/system-auth (content)[0m
[0;32m[0m[0;36m@@ -13,7 +13,7 @@[0m
[0;36m[0m account     required      pam_permit.so
 
 password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=
[0;31m-password    sufficient    pam_unix.so sha256 shadow nullok try_first_pass use_authtok[0m
[0;31m[0m[0;32m+password    sufficient    pam_unix.so yescrypt shadow nullok use_authtok remember=5 sha512[0m
[0;32m[0m password    required      pam_deny.so
 
 session     optional      pam_keyinit.so revoke

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.5.3 Ensure password reuse is limited | update file according to CIS] *************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.5.3/5.5.4 PAM checks] ************************************************************************************************************************************************************************************************
[0;31m--- before: /etc/pam.d/password-auth (content)[0m
[0;31m[0m[0;32m+++ after: /etc/pam.d/password-auth (content)[0m
[0;32m[0m[0;36m@@ -13,7 +13,7 @@[0m
[0;36m[0m account     required      pam_permit.so
 
 password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=
[0;31m-password    sufficient    pam_unix.so sha256 shadow nullok try_first_pass use_authtok[0m
[0;31m[0m[0;32m+password    sufficient    pam_unix.so yescrypt shadow nullok use_authtok remember=5 sha512[0m
[0;32m[0m 
 
 password    required      pam_deny.so

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.5.4 Ensure password reuse is limited | update /etc/pam.d/system-auth] ************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.5.4 Ensure password reuse is limited | update /etc/pam.d/password-auth] **********************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.5.4 Setting password hashing algorithm is sha512 / libuser.conf] *****************************************************************************************************************************************************
[0;31m--- before: /etc/libuser.conf[0m
[0;31m[0m[0;32m+++ after: /etc/libuser.conf[0m
[0;32m[0m[0;36m@@ -17,7 +17,7 @@[0m
[0;36m[0m # skeleton = /etc/skel
 # mailspooldir = /var/mail
 
[0;31m-crypt_style = sha256[0m
[0;31m[0m[0;32m+crypt_style = sha512[0m
[0;32m[0m modules = files shadow
 create_modules = files shadow
 # modules = files shadow ldap

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.5.4 Setting password hashing algorithm is sha512 / /etc/login.defs] **************************************************************************************************************************************************
[0;31m--- before: /etc/login.defs[0m
[0;31m[0m[0;32m+++ after: /etc/login.defs[0m
[0;32m[0m[0;36m@@ -68,6 +68,6 @@[0m
[0;36m[0m USERGROUPS_ENAB yes
 
 # Use SHA512 to encrypt password.
[0;31m-ENCRYPT_METHOD SHA256[0m
[0;31m[0m[0;32m+ENCRYPT_METHOD SHA512[0m
[0;32m[0m 
 MD5_CRYPT_ENAB no

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.6.1.2 - Ensure password change days is set to 7] *********************************************************************************************************************************************************************
[0;31m--- before: /etc/login.defs (content)[0m
[0;31m[0m[0;32m+++ after: /etc/login.defs (content)[0m
[0;32m[0m[0;36m@@ -23,7 +23,7 @@[0m
[0;36m[0m #	PASS_WARN_AGE	Number of days warning given before a password expires.
 #
 PASS_MAX_DAYS	99999
[0;31m-PASS_MIN_DAYS	0[0m
[0;31m[0m[0;32m+PASS_MIN_DAYS  7[0m
[0;32m[0m PASS_MIN_LEN	5
 PASS_WARN_AGE	7
 

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.6.1.3 - Ensure password warning days is set to 7] ********************************************************************************************************************************************************************
[0;31m--- before: /etc/login.defs (content)[0m
[0;31m[0m[0;32m+++ after: /etc/login.defs (content)[0m
[0;32m[0m[0;36m@@ -71,3 +71,4 @@[0m
[0;36m[0m ENCRYPT_METHOD SHA512
 
 MD5_CRYPT_ENAB no
[0;32m+PASS_WARN_AGE  7[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.6.1.5 Ensure all users last password change date is in the past | get list] ******************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.6.1.5 Ensure all users last password change date is in the past | save list] *****************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-641482lzsduu2b/tmp6wtq35el[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.6.3 - Ensure default shell timeout is 900 seconds or less] ***********************************************************************************************************************************************************
[0;31m--- before: /etc/profile (content)[0m
[0;31m[0m[0;32m+++ after: /etc/profile (content)[0m
[0;32m[0m[0;36m@@ -74,3 +74,4 @@[0m
[0;36m[0m 
 unset i
 unset -f pathmunge
[0;32m+readonly TMOUT=900 ; export TMOUT[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=/etc/profile)[0m

TASK [cis_security : 5.6.4 - Ensure default group for root is GID 0] ************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.6.5 - Ensure umask is set] *******************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => (item=/etc/bashrc)[0m
[0;32mok: [dcex1441pjv1hw9] => (item=/etc/profile)[0m

TASK [cis_security : 5.7 - Configure PAM to only allow su from wheel group] *****************************************************************************************************************************************************************
[0;31m--- before: /etc/pam.d/su[0m
[0;31m[0m[0;32m+++ after: /etc/pam.d/su[0m
[0;32m[0m[0;36m@@ -4,7 +4,7 @@[0m
[0;36m[0m # Uncomment the following line to implicitly trust users in the "wheel" group.
 #auth		sufficient	pam_wheel.so trust use_uid
 # Uncomment the following line to require a user to be in the "wheel" group.
[0;31m-#auth		required	pam_wheel.so use_uid[0m
[0;31m[0m[0;32m+auth         required        pam_wheel.so use_uid[0m
[0;32m[0m auth		substack	system-auth
 auth		include		postlogin
 account		sufficient	pam_succeed_if.so uid = 0 use_uid quiet

[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 5.7 - Add root to the wheel group] *************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.1.2 - Find any world writiable files directories] ********************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.1.2 - Print any world writable directories found] ********************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.1.2 Remove any world writiable files directories] ********************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.1.[3,9] - Ensure permissions on /etc/passwd /etc/group] **************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => (item=gshadow-)[0m
[0;32mok: [dcex1441pjv1hw9] => (item=shadow-)[0m
[0;32mok: [dcex1441pjv1hw9] => (item=shadow)[0m
[0;32mok: [dcex1441pjv1hw9] => (item=gshadow)[0m

TASK [cis_security : 6.1.[6-10] - Ensure permissions on /etc/passwd- /etc/[g]shadow- /etc/group-] *******************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9] => (item=passwd)[0m
[0;32mok: [dcex1441pjv1hw9] => (item=passwd-)[0m
[0;32mok: [dcex1441pjv1hw9] => (item=group)[0m
[0;32mok: [dcex1441pjv1hw9] => (item=group-)[0m

TASK [cis_security : 6.1.11 - Find any world writiable files] *******************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.1.11 - Print any world writable files found] *************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.1.12 - Find any unowned files] ***************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.1.12 - Print any unowned files found] ********************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.1.13 - Find any ungrouped files] *************************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.1.13 - Print any ungrouped files found] ******************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.1 - Check to see if there are any accounts with empty passwords] ***************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.1 - Report the named users to the report] **************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.2 - Use script to pull the list of groups] *************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.2 - Report to user any unreferenced groups] ************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.3 - Use script to pull the list of duplicate UIDs] *****************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.3 - Print report of duplicated UIDs to user] ***********************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.4 - Use script to pull the list of duplicate GIDs] *****************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.4 - Print report of duplcate GIDs to user] *************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.5 - Use script to pull the list of users] **************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.5 - Print report of duplicate users to user] ***********************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.6 - Use script to pull the list of groups] *************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.6 - Print report of duplicate groups to user] **********************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.7 - Run script on path variable] ***********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.7 - Print report to user] ******************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.8 - find accounts with UID of 0] ***********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.8 - Report on mulitple accounts with UID of 0] *********************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.9 - Use script to find the users] **********************************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.9 - Print report of users that do not have a home directory] *******************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9] => {[0m
[0;33m    "msg": [[0m
[0;33m        "User: \"elasticsearch\" home directory: \"/home/elasticsearch\" does not exist."[0m
[0;33m    ][0m
[0;33m}[0m

TASK [cis_security : 6.2.9 Ensure all users' home directories exist | list] *****************************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.9 Ensure all users' home directories exist | save] *****************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-641482lzsduu2b/tmp5310zizf[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+["rpc", "ntp", "fsbg-mdr", "elasticsearch", "tss"][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.9 Ensure all users' home directories exist | fix] ******************************************************************************************************************************************************************
[1;35m[WARNING]: conditional statements should not include jinja2 templating delimiters such as {{ }} or {% %}. Found: {{ output_6_2_9.stdout_lines|length > 0 }}[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=rpc)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=ntp)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=fsbg-mdr)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=elasticsearch)[0m
[0;32mok: [dcex1441pjv1hw9] => (item=tss)[0m

TASK [cis_security : 6.2.10 - Determine if the shadow group exists in /etc/group] ***********************************************************************************************************************************************************
[0;32mok: [dcex1441pjv1hw9][0m

TASK [cis_security : 6.2.10 - Print report of shadow group to user] *************************************************************************************************************************************************************************
[0;36mskipping: [dcex1441pjv1hw9][0m

TASK [cis_security : Add hardening file.] ***************************************************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,7 +1,7 @@[0m
[0;36m[0m {
[0;31m-    "atime": 1685611201.471975,[0m
[0;31m[0m[0;31m-    "mode": "0640",[0m
[0;31m[0m[0;31m-    "mtime": 1685611201.471975,[0m
[0;31m[0m[0;32m+    "atime": 1685611201.4734433,[0m
[0;32m[0m[0;32m+    "mode": "0400",[0m
[0;32m[0m[0;32m+    "mtime": 1685611201.4734433,[0m
[0;32m[0m     "path": "/etc/.hardening",
[0;31m-    "state": "absent"[0m
[0;31m[0m[0;32m+    "state": "touch"[0m
[0;32m[0m }

[0;33mchanged: [dcex1441pjv1hw9][0m

RUNNING HANDLER [cis_security : restart sshd] ***********************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

RUNNING HANDLER [cis_security : restart chronyd] ********************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

RUNNING HANDLER [cis_security : restart postfix] ********************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

RUNNING HANDLER [cis_security : rebuild grub] ***********************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9][0m

RUNNING HANDLER [cis_security : flush network routes] ***************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv4.route.flush)[0m
[0;33mchanged: [dcex1441pjv1hw9] => (item=net.ipv6.route.flush)[0m

PLAY RECAP **********************************************************************************************************************************************************************************************************************************
[0;33mdcex1441pjv1hw9[0m            : [0;32mok=170 [0m [0;33mchanged=69  [0m unreachable=0    failed=0    [0;36mskipped=29  [0m rescued=0    [1;35mignored=2   [0m


Script done on 2023-06-01 11:20:09+02:00
