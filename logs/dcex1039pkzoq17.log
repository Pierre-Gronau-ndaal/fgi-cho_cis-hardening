Script started on 2023-05-25 13:52:44+02:00
[1;35m[WARNING]: While constructing a mapping from /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/defaults/main.yml, line 6, column 1, found a duplicate dict key (enable_firewall). Using last defined value only.[0m
[1;35m[WARNING]: While constructing a mapping from /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/defaults/main.yml, line 6, column 1, found a duplicate dict key (ssh_max_sessions). Using last defined value only.[0m
[0;35m[DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. See https://docs.ansible.com/ansible-core/2.14/user_guide/playbooks_reuse_includes.html for details. This feature will be removed in version 2.16. [0m
[0;35mDeprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.[0m

PLAY [all] **********************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] **********************************************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : include] ***************************************************************************************************************************************************************************************************************
[0;35m[DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks/import_playbook instead. This feature will be removed in version 2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in [0m
[0;35mansible.cfg.[0m
[0;36mincluded: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/CIS-Ubuntu-20.yml for dcex1039pkzoq17[0m

TASK [cis_security : include] ***************************************************************************************************************************************************************************************************************
[0;36mincluded: /home/gfk.com/ivan.stamov.adm/cis-hardening/roles/cis_security/tasks/type-files/ubuntu-20-type.yml for dcex1039pkzoq17[0m

TASK [cis_security : 1.1.1.1 Ensure mounting of cramfs filesystems is disabled] *************************************************************************************************************************************************************
[0;31m--- before: /etc/modprobe.d/CIS.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/CIS.conf (content)[0m
[0;32m[0m[0;36m@@ -1 +1,2 @@[0m
[0;36m[0m install jffs2 /bin/true
[0;32m+install cramfs /bin/true[0m
[0;32m[0m
[0;31m--- before: /etc/modprobe.d/CIS.conf (file attributes)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/CIS.conf (file attributes)[0m
[0;32m[0m[0;36m@@ -1,3 +1,3 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0640"[0m
[0;31m[0m[0;32m+    "mode": "0644"[0m
[0;32m[0m }

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.1.1 Ensure mounting of cramfs filesystems is disabled | modprobe] **************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.1.2 Ensure mounting of freevxfs filesystems is disabled] ***********************************************************************************************************************************************************
[0;31m--- before: /etc/modprobe.d/CIS.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/CIS.conf (content)[0m
[0;32m[0m[0;36m@@ -1,2 +1,3 @@[0m
[0;36m[0m install jffs2 /bin/true
 install cramfs /bin/true
[0;32m+install freevxfs /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.1.2 Ensure mounting of freevxfs filesystems is disabled | modprobe] ************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.1.3 Ensure mounting of jffs2 filesystems is disabled] **************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.1.3 Ensure mounting of jffs2 filesystems is disabled] **************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.1.4 Ensure mounting of hfs filesystems is disabled] ****************************************************************************************************************************************************************
[0;31m--- before: /etc/modprobe.d/CIS.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/CIS.conf (content)[0m
[0;32m[0m[0;36m@@ -1,3 +1,4 @@[0m
[0;36m[0m install jffs2 /bin/true
 install cramfs /bin/true
 install freevxfs /bin/true
[0;32m+install hfs /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.1.4 Ensure mounting of hfs filesystems is disabled | modprobe] *****************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.1.5 Ensure mounting of hfsplus filesystems is disabled] ************************************************************************************************************************************************************
[0;31m--- before: /etc/modprobe.d/CIS.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/CIS.conf (content)[0m
[0;32m[0m[0;36m@@ -2,3 +2,4 @@[0m
[0;36m[0m install cramfs /bin/true
 install freevxfs /bin/true
 install hfs /bin/true
[0;32m+install hfsplus /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.1.5 Ensure mounting of hfsplus filesystems is disabled | modprobe] *************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.1.7 Ensure mounting of udf filesystems is disabled] ****************************************************************************************************************************************************************
[0;31m--- before: /etc/modprobe.d/CIS.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/CIS.conf (content)[0m
[0;32m[0m[0;36m@@ -3,3 +3,4 @@[0m
[0;36m[0m install freevxfs /bin/true
 install hfs /bin/true
 install hfsplus /bin/true
[0;32m+install udf /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.1.7 Ensure mounting of udf filesystems is disabled | modprobe] *****************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.2 Ensure /tmp is configured] ***************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.2 Ensure /tmp is configured | edit file] ***************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.2 Ensure /tmp is configured | reload demon] ************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.2 Ensure /tmp is configured | enable and start tmp.mount] **********************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : Get file system] *******************************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : debug] *****************************************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17] => {[0m
[0;32m    "filesystem.stdout": "ext4"[0m
[0;32m}[0m

TASK [cis_security : Check /tmp config] *****************************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : Remount /tmp] **********************************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.6 Ensure /dev/shm is configured
 1.1.7 Ensure nodev option set on /dev/shm partition
 1.1.8 Ensure nosuid option set on /dev/shm partition
 1.1.9 Ensure noexec option set on /dev/shm partition] *********************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.12 Ensure nodev option set on /var/tmp partitions] *****************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : /var/tmp partitions] ***************************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17] => {[0m
[0;32m    "msg": {[0m
[0;32m        "changed": false,[0m
[0;32m        "cmd": "mount | grep \"on /var\" && true || true\n",[0m
[0;32m        "delta": "0:00:00.005057",[0m
[0;32m        "end": "2023-05-25 13:52:54.650986",[0m
[0;32m        "failed": false,[0m
[0;32m        "msg": "",[0m
[0;32m        "rc": 0,[0m
[0;32m        "start": "2023-05-25 13:52:54.645929",[0m
[0;32m        "stderr": "",[0m
[0;32m        "stderr_lines": [],[0m
[0;32m        "stdout": "/dev/mapper/system-var on /var type ext4 (rw,nosuid,nodev,relatime)\n/dev/mapper/system-log on /var/log type ext4 (rw,nodev,relatime)\n/dev/mapper/system-audit on /var/log/audit type ext4 (rw,nodev,relatime)\noverlay on /var/lib/docker/overlay2/79ee7dfa9553750dce7a980b2e64cb2a0d6609b759bc7364b8c3f32cd5d4a10f/merged type overlay (rw,relatime,lowerdir=/var/lib/docker/overlay2/l/3W24OLADQQLL76RKJQQ2OAHBIK:/var/lib/docker/overlay2/l/ND2TU5INZ2IH3RHCZ7HAFLN3BA:/var/lib/docker/overlay2/l/JITCKY4PJW46V5HZSGKLZ5NZ52:/var/lib/docker/overlay2/l/LLE7PSSF26RDLOEC4Z6CDXNJ6Q,upperdir=/var/lib/docker/overlay2/79ee7dfa9553750dce7a980b2e64cb2a0d6609b759bc7364b8c3f32cd5d4a10f/diff,workdir=/var/lib/docker/overlay2/79ee7dfa9553750dce7a980b2e64cb2a0d6609b759bc7364b8c3f32cd5d4a10f/work,xino=off)\nshm on /var/lib/docker/containers/7747e7f301c962b313868a5e829ca423fb31c46f540d13710bed0176109d347a/mounts/shm type tmpfs (rw,nosuid,nodev,noexec,relatime,size=65536k)\noverlay on /var/lib/docker/overlay2/ea7aa6a36476845e52aa0279e64b1c989390177f7238ea4551e7ca821cf95be9/merged type overlay (rw,relatime,lowerdir=/var/lib/docker/overlay2/l/7DAPGMYAW4BKFRZ6RPJLYXMHVV:/var/lib/docker/overlay2/l/NFBR4ANPNS3REJUVMNR7Z53W2Y:/var/lib/docker/overlay2/l/QZA3VQEOZQTEY44SHYVSK3PMGH:/var/lib/docker/overlay2/l/UDLN2LTEZPTDUDI4U5BW7IXGS3:/var/lib/docker/overlay2/l/L6ARLCDUNBN3I7QCOM5X4IMFUY:/var/lib/docker/overlay2/l/IXTVLGY64VOCDIIKTAU3KNP4P3:/var/lib/docker/overlay2/l/XFDY2532R263X5OZYH2NLW2IGL:/var/lib/docker/overlay2/l/JV6OUZBQ6AJZDWVEBKAE7GGT6Y:/var/lib/docker/overlay2/l/E6LSY7W2KMQO4IT52BSXVSVICU:/var/lib/docker/overlay2/l/C2ANWESOJ5OBF2QI4V2DXQYN6H:/var/lib/docker/overlay2/l/DQCBQPKDX2MPK6E7ELKADC2CQH,upperdir=/var/lib/docker/overlay2/ea7aa6a36476845e52aa0279e64b1c989390177f7238ea4551e7ca821cf95be9/diff,workdir=/var/lib/docker/overlay2/ea7aa6a36476845e52aa0279e64b1c989390177f7238ea4551e7ca821cf95be9/work,xino=off)\nshm on /var/lib/docker/containers/e4619d217e8f59c0daf5e982128cafa07a0f4ce6dc77e9442cdd1ed57be49d03/mounts/shm type tmpfs (rw,nosuid,nodev,noexec,relatime,size=65536k)\noverlay on /var/lib/docker/overlay2/0d848d39c0e264e382d9cbc0b3e7a68bc13a20dc7a453da6bcb9a771f41036bb/merged type overlay (rw,relatime,lowerdir=/var/lib/docker/overlay2/l/HC52FYSZK367QSDF3Q5UMNGSEZ:/var/lib/docker/overlay2/l/4AHGRG3RE4DREGB7AE2BXUUNYE:/var/lib/docker/overlay2/l/ATZCVHDZLAQGN3WJHBMIXP7MNM:/var/lib/docker/overlay2/l/JT4WM5GPQICCHNGIIGSJAKMJYA:/var/lib/docker/overlay2/l/4VO4CKXYWO52JPQZSU6D6ETO5E:/var/lib/docker/overlay2/l/DS5IQO5ZC4RW3VVWRKHSPYDO2G:/var/lib/docker/overlay2/l/S7S3BIBBSSFRA4IC53G7JT6KHY:/var/lib/docker/overlay2/l/ZGGH74SGIMIVII2M22EXUHYTFK:/var/lib/docker/overlay2/l/RLVBFC6USU5DZOSEI4C4ONNUZL:/var/lib/docker/overlay2/l/BDITO5UIDQE746OBR2V4INF4Z3:/var/lib/docker/overlay2/l/AEWROK573JCF2ALUPH2AUD5UAF:/var/lib/docker/overlay2/l/2UPOFPXD6PWDSWOYI746NO4V7N,upperdir=/var/lib/docker/overlay2/0d848d39c0e264e382d9cbc0b3e7a68bc13a20dc7a453da6bcb9a771f41036bb/diff,workdir=/var/lib/docker/overlay2/0d848d39c0e264e382d9cbc0b3e7a68bc13a20dc7a453da6bcb9a771f41036bb/work,xino=off)\nshm on /var/lib/docker/containers/3c7ec01168214ce7e917ecc64ea0f3b31367d65d5eb4471ea09e449488efbf00/mounts/shm type tmpfs (rw,nosuid,nodev,noexec,relatime,size=65536k)",[0m
[0;32m        "stdout_lines": [[0m
[0;32m            "/dev/mapper/system-var on /var type ext4 (rw,nosuid,nodev,relatime)",[0m
[0;32m            "/dev/mapper/system-log on /var/log type ext4 (rw,nodev,relatime)",[0m
[0;32m            "/dev/mapper/system-audit on /var/log/audit type ext4 (rw,nodev,relatime)",[0m
[0;32m            "overlay on /var/lib/docker/overlay2/79ee7dfa9553750dce7a980b2e64cb2a0d6609b759bc7364b8c3f32cd5d4a10f/merged type overlay (rw,relatime,lowerdir=/var/lib/docker/overlay2/l/3W24OLADQQLL76RKJQQ2OAHBIK:/var/lib/docker/overlay2/l/ND2TU5INZ2IH3RHCZ7HAFLN3BA:/var/lib/docker/overlay2/l/JITCKY4PJW46V5HZSGKLZ5NZ52:/var/lib/docker/overlay2/l/LLE7PSSF26RDLOEC4Z6CDXNJ6Q,upperdir=/var/lib/docker/overlay2/79ee7dfa9553750dce7a980b2e64cb2a0d6609b759bc7364b8c3f32cd5d4a10f/diff,workdir=/var/lib/docker/overlay2/79ee7dfa9553750dce7a980b2e64cb2a0d6609b759bc7364b8c3f32cd5d4a10f/work,xino=off)",[0m
[0;32m            "shm on /var/lib/docker/containers/7747e7f301c962b313868a5e829ca423fb31c46f540d13710bed0176109d347a/mounts/shm type tmpfs (rw,nosuid,nodev,noexec,relatime,size=65536k)",[0m
[0;32m            "overlay on /var/lib/docker/overlay2/ea7aa6a36476845e52aa0279e64b1c989390177f7238ea4551e7ca821cf95be9/merged type overlay (rw,relatime,lowerdir=/var/lib/docker/overlay2/l/7DAPGMYAW4BKFRZ6RPJLYXMHVV:/var/lib/docker/overlay2/l/NFBR4ANPNS3REJUVMNR7Z53W2Y:/var/lib/docker/overlay2/l/QZA3VQEOZQTEY44SHYVSK3PMGH:/var/lib/docker/overlay2/l/UDLN2LTEZPTDUDI4U5BW7IXGS3:/var/lib/docker/overlay2/l/L6ARLCDUNBN3I7QCOM5X4IMFUY:/var/lib/docker/overlay2/l/IXTVLGY64VOCDIIKTAU3KNP4P3:/var/lib/docker/overlay2/l/XFDY2532R263X5OZYH2NLW2IGL:/var/lib/docker/overlay2/l/JV6OUZBQ6AJZDWVEBKAE7GGT6Y:/var/lib/docker/overlay2/l/E6LSY7W2KMQO4IT52BSXVSVICU:/var/lib/docker/overlay2/l/C2ANWESOJ5OBF2QI4V2DXQYN6H:/var/lib/docker/overlay2/l/DQCBQPKDX2MPK6E7ELKADC2CQH,upperdir=/var/lib/docker/overlay2/ea7aa6a36476845e52aa0279e64b1c989390177f7238ea4551e7ca821cf95be9/diff,workdir=/var/lib/docker/overlay2/ea7aa6a36476845e52aa0279e64b1c989390177f7238ea4551e7ca821cf95be9/work,xino=off)",[0m
[0;32m            "shm on /var/lib/docker/containers/e4619d217e8f59c0daf5e982128cafa07a0f4ce6dc77e9442cdd1ed57be49d03/mounts/shm type tmpfs (rw,nosuid,nodev,noexec,relatime,size=65536k)",[0m
[0;32m            "overlay on /var/lib/docker/overlay2/0d848d39c0e264e382d9cbc0b3e7a68bc13a20dc7a453da6bcb9a771f41036bb/merged type overlay (rw,relatime,lowerdir=/var/lib/docker/overlay2/l/HC52FYSZK367QSDF3Q5UMNGSEZ:/var/lib/docker/overlay2/l/4AHGRG3RE4DREGB7AE2BXUUNYE:/var/lib/docker/overlay2/l/ATZCVHDZLAQGN3WJHBMIXP7MNM:/var/lib/docker/overlay2/l/JT4WM5GPQICCHNGIIGSJAKMJYA:/var/lib/docker/overlay2/l/4VO4CKXYWO52JPQZSU6D6ETO5E:/var/lib/docker/overlay2/l/DS5IQO5ZC4RW3VVWRKHSPYDO2G:/var/lib/docker/overlay2/l/S7S3BIBBSSFRA4IC53G7JT6KHY:/var/lib/docker/overlay2/l/ZGGH74SGIMIVII2M22EXUHYTFK:/var/lib/docker/overlay2/l/RLVBFC6USU5DZOSEI4C4ONNUZL:/var/lib/docker/overlay2/l/BDITO5UIDQE746OBR2V4INF4Z3:/var/lib/docker/overlay2/l/AEWROK573JCF2ALUPH2AUD5UAF:/var/lib/docker/overlay2/l/2UPOFPXD6PWDSWOYI746NO4V7N,upperdir=/var/lib/docker/overlay2/0d848d39c0e264e382d9cbc0b3e7a68bc13a20dc7a453da6bcb9a771f41036bb/diff,workdir=/var/lib/docker/overlay2/0d848d39c0e264e382d9cbc0b3e7a68bc13a20dc7a453da6bcb9a771f41036bb/work,xino=off)",[0m
[0;32m            "shm on /var/lib/docker/containers/3c7ec01168214ce7e917ecc64ea0f3b31367d65d5eb4471ea09e449488efbf00/mounts/shm type tmpfs (rw,nosuid,nodev,noexec,relatime,size=65536k)"[0m
[0;32m        ][0m
[0;32m    }[0m
[0;32m}[0m

TASK [cis_security : 1.1.18 Ensure nodev option set on /home partition] *********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17] => {[0m
[0;32m    "msg": "For new installations, during installation create a custom partition setup and specify a separate partition"[0m
[0;32m}[0m

TASK [cis_security : 1.1.22 Ensure sticky bit is set on all world-writable directories | get info] ******************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.22 Ensure sticky bit is set on all world-writable directories | fix] ***********************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.23 Disable Automounting | service disable] *************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.23 Disable Automounting | package remove] **************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.24 Disable USB Storage | modprobe] *********************************************************************************************************************************************************************************
[0;31m--- before: /etc/modprobe.d/CIS.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/modprobe.d/CIS.conf (content)[0m
[0;32m[0m[0;36m@@ -4,3 +4,4 @@[0m
[0;36m[0m install hfs /bin/true
 install hfsplus /bin/true
 install udf /bin/true
[0;32m+install usb-storage /bin/true[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.1.24 Disable USB Storage] ********************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.3.1 Ensure AIDE is installed] ****************************************************************************************************************************************************************************************
The following additional packages will be installed:
  bsd-mailx liblockfile-bin liblockfile1 postfix
Suggested packages:
  figlet procmail postfix-mysql postfix-pgsql postfix-ldap postfix-pcre
  postfix-lmdb postfix-sqlite sasl2-bin | dovecot-common resolvconf
  postfix-cdb postfix-doc
The following NEW packages will be installed:
  aide aide-common bsd-mailx liblockfile-bin liblockfile1 postfix
0 upgraded, 6 newly installed, 0 to remove and 40 not upgraded.
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.4.1 Ensure permissions on bootloader config are not overridden - step 1 - update chmod 444 to chmod 400 in /usr/sbin/grubmkconfig] ***********************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.4.1 Ensure permissions on bootloader config are not overridden - step 2 -  check on password not being set before running chmod command] *****************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.4.3 Ensure permissions on bootloader config are configured] **********************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0444",[0m
[0;31m[0m[0;32m+    "mode": "0400",[0m
[0;32m[0m     "path": "/boot/grub/grub.cfg"
 }

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.5.2 Ensure address space layout randomization (ASLR) is enabled] *****************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.5.3 Ensure prelink is not installed] *********************************************************************************************************************************************************************************
[0;31mfatal: [dcex1039pkzoq17]: FAILED! => {"changed": false, "cmd": "prelink -ua", "msg": "[Errno 2] No such file or directory: b'prelink'", "rc": 2, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}[0m
[0;36m...ignoring[0m

TASK [cis_security : 1.5.3 Ensure prelink is not installed] *********************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.5.4 Ensure core dumps are restricted | sysctl] ***********************************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.5.4 Ensure core dumps are restricted | limits.conf] ******************************************************************************************************************************************************************
[0;31m--- before: /etc/security/limits.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/security/limits.conf (content)[0m
[0;32m[0m[0;36m@@ -53,4 +53,5 @@[0m
[0;36m[0m #ftp             -       chroot          /ftp
 #@student        -       maxlogins       4
 
[0;32m+*                hard    core            0[0m
[0;32m[0m # End of file

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.5.4 Ensure core dumps are restricted | apt] **************************************************************************************************************************************************************************
The following packages were automatically installed and are no longer required:
  apport-symptoms python3-apport python3-problem-report python3-systemd
Use 'apt autoremove' to remove them.
The following packages will be REMOVED:
  apport
The following NEW packages will be installed:
  systemd-coredump
0 upgraded, 1 newly installed, 1 to remove and 40 not upgraded.
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.5.4 Ensure core dumps are restricted | coredump.conf] ****************************************************************************************************************************************************************
[0;31m--- before: /etc/systemd/coredump.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/coredump.conf (content)[0m
[0;32m[0m[0;36m@@ -12,7 +12,7 @@[0m
[0;36m[0m # See coredump.conf(5) for details.
 
 [Coredump]
[0;31m-#Storage=external[0m
[0;31m[0m[0;32m+Storage=none[0m
[0;32m[0m #Compress=yes
 #ProcessSizeMax=2G
 #ExternalSizeMax=2G

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.5.4 Ensure core dumps are restricted | coredump.conf] ****************************************************************************************************************************************************************
[0;31m--- before: /etc/systemd/coredump.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/coredump.conf (content)[0m
[0;32m[0m[0;36m@@ -14,7 +14,7 @@[0m
[0;36m[0m [Coredump]
 Storage=none
 #Compress=yes
[0;31m-#ProcessSizeMax=2G[0m
[0;31m[0m[0;32m+ProcessSizeMax=0[0m
[0;32m[0m #ExternalSizeMax=2G
 #JournalSizeMax=767M
 #MaxUse=

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.5.4 Ensure core dumps are restricted | reload] ***********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.6.1.1 Ensure AppArmor is installed] **********************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode
 1.6.1.4 Ensure all AppArmor Profiles are enforcing] ***********************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 1.7.1 Ensure message of the day is configured properly
 1.7.4 Ensure permissions on /etc/motd are configured] ***********************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmpnjeyorfk/motd.j2[0m
[0;32m[0m[0;36m@@ -0,0 +1,6 @@[0m
[0;36m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.7.1 Ensure message of the day is configured properly
 1.7.4 Ensure permissions on /etc/motd are configured  | Show templates used] ************************************************************************************
[0;32mok: [dcex1039pkzoq17] => {[0m
[0;32m    "msg": "custom file not found, using default"[0m
[0;32m}[0m

TASK [cis_security : 1.7.2 Ensure local login warning banner is configured properly
 1.7.5 Ensure permissions on /etc/issue are configured] **************************************************************************************************
[0;31m--- before: /etc/issue[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmp4kfmmkxj/issue.j2[0m
[0;32m[0m[0;36m@@ -1,2 +1,5 @@[0m
[0;36m[0m[0;31m-Ubuntu 20.04.3 LTS \n \l[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.7.2 Ensure local login warning banner is configured properly
 1.7.5 Ensure permissions on /etc/issue are configured  | Show templates used] ***************************************************************************
[0;32mok: [dcex1039pkzoq17] => {[0m
[0;32m    "msg": "custom file not found, using default"[0m
[0;32m}[0m

TASK [cis_security : 1.7.3 Ensure local remote warning banner is configured properly
 1.7.6 Ensure permissions on /etc/issue.net are configured] *********************************************************************************************
[0;31m--- before: /etc/issue.net[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmp8v92lejh/issue.net.j2[0m
[0;32m[0m[0;36m@@ -1 +1,5 @@[0m
[0;36m[0m[0;31m-Ubuntu 20.04.3 LTS[0m
[0;31m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m[0;32m+WARNING: This is a private system.  Do not attempt to login unless you are an[0m
[0;32m[0m[0;32m+authorized user.  Any authorized or unauthorized access and use may be moni-[0m
[0;32m[0m[0;32m+tored and can result in criminal or civil prosecution under applicable law.[0m
[0;32m[0m[0;32m+-----------------------------------------------------------------------------[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 1.7.3 Ensure remote login warning banner is configured properly
 1.7.6 Ensure permissions on /etc/issue.net are configured  | Show templates used] **********************************************************************
[0;32mok: [dcex1039pkzoq17] => {[0m
[0;32m    "msg": "custom file not found, using default"[0m
[0;32m}[0m

TASK [cis_security : 2.1.1.1 Ensure time synchronization is in use - service install] *******************************************************************************************************************************************************
The following packages were automatically installed and are no longer required:
  apport-symptoms python3-apport python3-problem-report python3-systemd
Use 'apt autoremove' to remove them.
The following packages will be REMOVED:
  systemd-timesyncd
The following NEW packages will be installed:
  chrony
0 upgraded, 1 newly installed, 1 to remove and 40 not upgraded.
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.1.1 Ensure time synchronization is in use - service start] *********************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.1.2 Remove NTP] ****************************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.1.2 Ensure systemd-timesyncd is configured | install systemd-timesyncd] ********************************************************************************************************************************************
The following packages were automatically installed and are no longer required:
  apport-symptoms python3-apport python3-problem-report python3-systemd
Use 'apt autoremove' to remove them.
The following packages will be REMOVED:
  chrony
The following NEW packages will be installed:
  systemd-timesyncd
0 upgraded, 1 newly installed, 1 to remove and 40 not upgraded.
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.1.2 Ensure systemd-timesyncd is configured | set timezone] *********************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.1.2 Ensure systemd-timesyncd is configured | Configure systemd-timesyncd] ******************************************************************************************************************************************
[0;31m--- before: /etc/systemd/timesyncd.conf[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmp5xywjg5m/timesyncd.conf.j2[0m
[0;32m[0m[0;36m@@ -1,19 +1,4 @@[0m
[0;36m[0m[0;31m-#  This file is part of systemd.[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-#  systemd is free software; you can redistribute it and/or modify it[0m
[0;31m[0m[0;31m-#  under the terms of the GNU Lesser General Public License as published by[0m
[0;31m[0m[0;31m-#  the Free Software Foundation; either version 2.1 of the License, or[0m
[0;31m[0m[0;31m-#  (at your option) any later version.[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-# Entries in this file show the compile time defaults.[0m
[0;31m[0m[0;31m-# You can change settings by editing this file.[0m
[0;31m[0m[0;31m-# Defaults can be restored by simply deleting this file.[0m
[0;31m[0m[0;31m-#[0m
[0;31m[0m[0;31m-# See timesyncd.conf(5) for details.[0m
[0;31m[0m[0;31m-[0m
[0;31m[0m[0;32m+# Ansible managed[0m
[0;32m[0m [Time]
[0;31m-NTP=uxtime1.gfk.de uxtime2.gfk.de[0m
[0;31m[0m[0;31m-#FallbackNTP=ntp.ubuntu.com[0m
[0;31m[0m[0;31m-#RootDistanceMaxSec=5[0m
[0;31m[0m[0;31m-#PollIntervalMinSec=32[0m
[0;31m[0m[0;31m-#PollIntervalMaxSec=2048[0m
[0;31m[0m[0;32m+NTP=[0m
[0;32m[0m[0;32m+FallbackNTP=uxtime1.gfk.de uxtime2.gfk.de[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.1.2 Ensure systemd-timesyncd is configured | Start and enable systemd-timesyncd] ***********************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.1.3 Remove NTP] ****************************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.1.3 Ensure chrony is configured | Install Chrony] ******************************************************************************************************************************************************************
The following packages were automatically installed and are no longer required:
  apport-symptoms python3-apport python3-problem-report python3-systemd
Use 'apt autoremove' to remove them.
The following packages will be REMOVED:
  systemd-timesyncd
The following NEW packages will be installed:
  chrony
0 upgraded, 1 newly installed, 1 to remove and 40 not upgraded.
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.1.3 Ensure chrony is configured | Start Chrony service] ************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.1.3 Ensure chrony is configured | Generate configuration] **********************************************************************************************************************************************************
[0;31m--- before: /etc/chrony/chrony.conf[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmpqvpkf7_v/chrony.conf.j2[0m
[0;32m[0m[0;36m@@ -14,10 +14,8 @@[0m
[0;36m[0m # About using servers from the NTP Pool Project in general see (LP: #104525).
 # Approved by Ubuntu Technical Board on 2011-02-08.
 # See http://www.pool.ntp.org/join.html for more information.
[0;31m-pool ntp.ubuntu.com        iburst maxsources 4[0m
[0;31m[0m[0;31m-pool 0.ubuntu.pool.ntp.org iburst maxsources 1[0m
[0;31m[0m[0;31m-pool 1.ubuntu.pool.ntp.org iburst maxsources 1[0m
[0;31m[0m[0;31m-pool 2.ubuntu.pool.ntp.org iburst maxsources 2[0m
[0;31m[0m[0;32m+server uxtime1.gfk.de iburst[0m
[0;32m[0m[0;32m+server uxtime2.gfk.de iburst[0m
[0;32m[0m 
 # This directive specify the location of the file containing ID/key pairs for
 # NTP authentication.

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.1.3 Ensure chrony is configured | Restart Chrony service] **********************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.2 Ensure X Window System is not installed] *************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.3 Ensure Avahi Server is not installed] ****************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.4 Ensure CUPS is not installed] ************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.5 Ensure DHCP Server is not installed] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.6 Ensure LDAP server is not installed] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.7 Ensure NFS is not installed] *************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.8 Ensure DNS Server is not installed] ******************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.9 Ensure FTP Server is not installed] ******************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.10 Ensure HTTP server is not installed] ****************************************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.11 Ensure IMAP and POP3 server are not installed] ******************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.12 Check is Samba is operational] **********************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.12 Check for log files] ********************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.12 Cheking for Samba logs] *****************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17] => {[0m
[0;32m    "smbd_logs.matched": "0"[0m
[0;32m}[0m

TASK [cis_security : 2.1.12 Cheking for Samba service] **************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17] => {[0m
[0;32m    "smbd_service.status.ActiveState": "inactive"[0m
[0;32m}[0m

TASK [cis_security : 2.1.12 Ensure Samba is not installed] **********************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.13 Ensure HTTP Proxy Server is not installed] **********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.14 Ensure SNMP Server is not installed] ****************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.15 Ensure mail transfer agent is configured for local-only mode] ***************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.15 Ensure mail transfer agent is configured for local-only mode] ***************************************************************************************************************************************************
[0;31m--- before: /etc/postfix/main.cf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/postfix/main.cf (content)[0m
[0;32m[0m[0;36m@@ -43,5 +43,5 @@[0m
[0;36m[0m mynetworks = 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128
 mailbox_size_limit = 0
 recipient_delimiter = +
[0;31m-inet_interfaces = all[0m
[0;31m[0m[0;32m+inet_interfaces = 127.0.0.1[0m
[0;32m[0m inet_protocols = ipv4

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.15 Restart Mail transfer agent] ************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.16 Ensure rsync service is not installed] **************************************************************************************************************************************************************************
The following packages were automatically installed and are no longer required:
  apport-symptoms python3-apport python3-problem-report python3-systemd
Use 'apt autoremove' to remove them.
The following packages will be REMOVED:
  rsync* ubuntu-standard*
0 upgraded, 0 newly installed, 2 to remove and 40 not upgraded.
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 2.1.17 Ensure NIS Server is not installed] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.2.1 Ensure NIS Client is not installed] ******************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.2.2 Ensure rsh client is not installed] ******************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.2.3 Ensure talk client is not installed] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 2.2.4 Ensure telnet client is not installed] ***************************************************************************************************************************************************************************
The following packages were automatically installed and are no longer required:
  apport-symptoms python3-apport python3-problem-report python3-systemd
Use 'apt autoremove' to remove them.
The following packages will be REMOVED:
  telnet*
0 upgraded, 0 newly installed, 1 to remove and 40 not upgraded.
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 2.2.5 Ensure LDAP client is not installed] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : verify no wireless interfaces are active on the system] ****************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 3.1.2 Ensure wireless interfaces are disabled] *************************************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 3.2.1 Ensure packet redirect sending is disabled | set] ****************************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17] => (item={'name': 'net.ipv4.conf.all.send_redirects', 'value': 0})[0m
[0;33mchanged: [dcex1039pkzoq17] => (item={'name': 'net.ipv4.conf.default.send_redirects', 'value': 0})[0m

TASK [cis_security : 3.2.1 Ensure packet redirect sending is disabled | load] ***************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 3.2.2 Ensure IP forwarding is disabled | ipv4"] ************************************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 3.2.2 Ensure IP forwarding is disabled | ipv6"] ************************************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 3.2.2 Ensure IP forwarding is disabled | IPV4 load"] *******************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 3.2.2 Ensure IP forwarding is disabled | IPV6 load"] *******************************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.1 Ensure source routed packets are not accepted | ipv4"] ***********************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17] => (item={'name': 'net.ipv4.conf.all.accept_source_route', 'value': 0})[0m
[0;33mchanged: [dcex1039pkzoq17] => (item={'name': 'net.ipv4.conf.default.accept_source_route', 'value': 0})[0m

TASK [cis_security : 3.3.1 Ensure source routed packets are not accepted | ipv4 load"] ******************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.1 Ensure source routed packets are not accepted | ipv6"] ***********************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17] => (item={'name': 'net.ipv6.conf.all.accept_source_route', 'value': 0}) [0m
[0;36mskipping: [dcex1039pkzoq17] => (item={'name': 'net.ipv6.conf.default.accept_source_route', 'value': 0}) [0m
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.1 Ensure source routed packets are not accepted | ipv6 load"] ******************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.2 Ensure ICMP redirects are not accepted | ipv4"] ******************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17] => (item={'name': 'net.ipv4.conf.all.accept_redirects', 'value': 0})[0m
[0;32mok: [dcex1039pkzoq17] => (item={'name': 'net.ipv4.conf.default.accept_redirects', 'value': 0})[0m

TASK [cis_security : shell] *****************************************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.2 Ensure ICMP redirects are not accepted | ipv6"] ******************************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17] => (item={'name': 'net.ipv6.conf.all.accept_redirects', 'value': 0}) [0m
[0;36mskipping: [dcex1039pkzoq17] => (item={'name': 'net.ipv6.conf.default.accept_redirects', 'value': 0}) [0m
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : shell] *****************************************************************************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.3 Ensure secure ICMP redirects are not accepted | save] ************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17] => (item={'name': 'net.ipv4.conf.all.secure_redirects', 'value': 0})[0m
[0;32mok: [dcex1039pkzoq17] => (item={'name': 'net.ipv4.conf.default.secure_redirects', 'value': 0})[0m

TASK [cis_security : 3.3.3 Ensure secure ICMP redirects are not accepted | load] ************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.4 Ensure suspicious packets are logged | save] *********************************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17] => (item={'name': 'net.ipv4.conf.all.log_martians', 'value': 1})[0m
[0;33mchanged: [dcex1039pkzoq17] => (item={'name': 'net.ipv4.conf.default.log_martians', 'value': 1})[0m

TASK [cis_security : 3.3.4 Ensure suspicious packets are logged | load] *********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.5 Ensure broadcast ICMP requests are ignored | save] ***************************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.5 Ensure broadcast ICMP requests are ignored | load] ***************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.6 Ensure bogus ICMP responses are ignored | save] ******************************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.6 Ensure bogus ICMP responses are ignored | load] ******************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.7 Ensure Reverse Path Filtering is enabled | save] *****************************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17] => (item={'name': 'net.ipv4.conf.all.rp_filter', 'value': 1})[0m
[0;33mchanged: [dcex1039pkzoq17] => (item={'name': 'net.ipv4.conf.default.rp_filter', 'value': 1})[0m

TASK [cis_security : 3.3.7 Ensure Reverse Path Filtering is enabled | load] *****************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.8 Ensure TCP SYN Cookies is enabled | save] ************************************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.8 Ensure TCP SYN Cookies is enabled | load] ************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.9 Ensure IPv6 router advertisements are not accepted | save] *******************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17] => (item={'name': 'net.ipv6.conf.all.accept_ra', 'value': 0}) [0m
[0;36mskipping: [dcex1039pkzoq17] => (item={'name': 'net.ipv6.conf.default.accept_ra', 'value': 0}) [0m
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 3.3.9 Ensure IPv6 router advertisements are not accepted | load] *******************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 3.5.1.1 Ensure ufw is installed | ufw] *********************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 3.5.1.2 Ensure iptables-persistent is not installed] *******************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 3.5.3.1.2 Ensure ufw is uninstalled or disabled with nftables] *********************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 4.2.1.1 Ensure rsyslog is installed] ***********************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 4.2.1.2 Ensure rsyslog Service is enabled] *****************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 4.2.1.4 Ensure rsyslog default file permissions configured] ************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 4.2.1.5 Ensure rsyslog default file permissions configured] ************************************************************************************************************************************************************
[0;31m--- before: /etc/rsyslog.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/rsyslog.conf (content)[0m
[0;32m[0m[0;36m@@ -57,3 +57,4 @@[0m
[0;36m[0m # Include all config files in /etc/rsyslog.d/
 #
 $IncludeConfig /etc/rsyslog.d/*.conf
[0;32m+ *.* action(type="omfwd" target="192.168.2.100" port="514" protocol="tcp"action.resumeRetryCount="100"queue.type="LinkedList" queue.size="1000")[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 4.2.2.1 Ensure journald is configured to send logs to rsyslog] *********************************************************************************************************************************************************
[0;31m--- before: /etc/systemd/journald.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/journald.conf (content)[0m
[0;32m[0m[0;36m@@ -29,7 +29,7 @@[0m
[0;36m[0m #RuntimeMaxFiles=100
 #MaxRetentionSec=
 #MaxFileSec=1month
[0;31m-#ForwardToSyslog=yes[0m
[0;31m[0m[0;32m+ForwardToSyslog=yes[0m
[0;32m[0m #ForwardToKMsg=no
 #ForwardToConsole=no
 #ForwardToWall=yes

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 4.2.2.2 Ensure journald is configured to compress large log files] *****************************************************************************************************************************************************
[0;31m--- before: /etc/systemd/journald.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/journald.conf (content)[0m
[0;32m[0m[0;36m@@ -13,7 +13,7 @@[0m
[0;36m[0m 
 [Journal]
 #Storage=auto
[0;31m-#Compress=yes[0m
[0;31m[0m[0;32m+Compress=yes[0m
[0;32m[0m #Seal=yes
 #SplitMode=uid
 #SyncIntervalSec=5m

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 4.2.2.3 Ensure journald is configured to write logfiles to persistent disk] ********************************************************************************************************************************************
[0;31m--- before: /etc/systemd/journald.conf (content)[0m
[0;31m[0m[0;32m+++ after: /etc/systemd/journald.conf (content)[0m
[0;32m[0m[0;36m@@ -12,7 +12,7 @@[0m
[0;36m[0m # See journald.conf(5) for details.
 
 [Journal]
[0;31m-#Storage=auto[0m
[0;31m[0m[0;32m+Storage=persistent[0m
[0;32m[0m Compress=yes
 #Seal=yes
 #SplitMode=uid

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.1.1 Ensure cron daemon is enabled and running] ***********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.1.2 Ensure permissions on /etc/crontab are configured] ***************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0644",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/crontab"
 }

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.1.3 Ensure permissions on /etc/cron.hourly are configured] ***********************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.hourly"
 }

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.1.4 Ensure permissions on /etc/cron.daily are configured] ************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.daily"
 }

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.1.5 Ensure permissions on /etc/cron.weekly are configured] ***********************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.weekly"
 }

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.1.6 Ensure permissions on /etc/cron.monthly are configured] **********************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.monthly"
 }

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.1.7 Ensure permissions on /etc/cron.d are configured] ****************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0755",[0m
[0;31m[0m[0;32m+    "mode": "0600",[0m
[0;32m[0m     "path": "/etc/cron.d"
 }

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.1.8 Ensure cron is restricted to authorized users | /etc/cron.deny] **************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : stat] ******************************************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.1.8 Ensure cron is restricted to authorized users | /etc/cron.allow] *************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,6 +1,6 @@[0m
[0;36m[0m {
[0;31m-    "atime": 1685015718.8467176,[0m
[0;31m[0m[0;31m-    "mtime": 1685015718.8467176,[0m
[0;31m[0m[0;32m+    "atime": 1685015718.8535814,[0m
[0;32m[0m[0;32m+    "mtime": 1685015718.8535814,[0m
[0;32m[0m     "path": "/etc/cron.allow",
[0;31m-    "state": "absent"[0m
[0;31m[0m[0;32m+    "state": "touch"[0m
[0;32m[0m }

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.1.9 Ensure at is restricted to authorized users | /etc/at.deny] ******************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
     "path": "/etc/at.deny",
[0;31m-    "state": "file"[0m
[0;31m[0m[0;32m+    "state": "absent"[0m
[0;32m[0m }

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : stat] ******************************************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.1.9 Ensure at is restricted to authorized users | /etc/at.allow] *****************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,6 +1,6 @@[0m
[0;36m[0m {
[0;31m-    "atime": 1685015719.7907073,[0m
[0;31m[0m[0;31m-    "mtime": 1685015719.7907073,[0m
[0;31m[0m[0;32m+    "atime": 1685015719.7966108,[0m
[0;32m[0m[0;32m+    "mtime": 1685015719.7966108,[0m
[0;32m[0m     "path": "/etc/at.allow",
[0;31m-    "state": "absent"[0m
[0;31m[0m[0;32m+    "state": "touch"[0m
[0;32m[0m }

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.2.1 Ensure sudo is installed] ****************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.2.2 Ensure sudo commands use pty] ************************************************************************************************************************************************************************************
[0;31m--- before: /etc/sudoers (content)[0m
[0;31m[0m[0;32m+++ after: /etc/sudoers (content)[0m
[0;32m[0m[0;36m@@ -28,3 +28,4 @@[0m
[0;36m[0m # See sudoers(5) for more information on "#include" directives:
 
 #includedir /etc/sudoers.d
[0;32m+Defaults use_pty[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.2.3 Ensure sudo log file exists] *************************************************************************************************************************************************************************************
[0;31m--- before: /etc/sudoers (content)[0m
[0;31m[0m[0;32m+++ after: /etc/sudoers (content)[0m
[0;32m[0m[0;36m@@ -29,3 +29,4 @@[0m
[0;36m[0m 
 #includedir /etc/sudoers.d
 Defaults use_pty
[0;32m+Defaults    logfile=/var/log/sudo.log[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.1 Ensure permissions on /etc/ssh/sshd_config are configured] *******************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.2 Ensure permissions on SSH private host key files are configured | find keys] *************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.2 Ensure permissions on SSH private host key files are configured | fix permissions] *******************************************************************************************************************************
[1;35m[WARNING]: conditional statements should not include jinja2 templating delimiters such as {{ }} or {% %}. Found: {{ private_keys.stdout_lines|length > 0 }}[0m
[0;32mok: [dcex1039pkzoq17] => (item=/etc/ssh/ssh_host_ed25519_key)[0m
[0;32mok: [dcex1039pkzoq17] => (item=/etc/ssh/ssh_host_dsa_key)[0m
[0;32mok: [dcex1039pkzoq17] => (item=/etc/ssh/ssh_host_ecdsa_key)[0m
[0;32mok: [dcex1039pkzoq17] => (item=/etc/ssh/ssh_host_rsa_key)[0m

TASK [cis_security : 5.3.3 Ensure permissions on SSH public host key files are configured | find keys] **************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.3 Ensure permissions on SSH public host key files are configured | fix permissions] ********************************************************************************************************************************
[1;35m[WARNING]: conditional statements should not include jinja2 templating delimiters such as {{ }} or {% %}. Found: {{ public_keys.stdout_lines|length > 0 }}[0m
[0;32mok: [dcex1039pkzoq17] => (item=/etc/ssh/ssh_host_rsa_key.pub)[0m
[0;32mok: [dcex1039pkzoq17] => (item=/etc/ssh/ssh_host_ed25519_key.pub)[0m
[0;32mok: [dcex1039pkzoq17] => (item=/etc/ssh/ssh_host_ecdsa_key.pub)[0m
[0;32mok: [dcex1039pkzoq17] => (item=/etc/ssh/ssh_host_dsa_key.pub)[0m

TASK [cis_security : 5.3.4 Ensure SSH access is limited | allow groups] *********************************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.4 Ensure SSH access is limited | denyusers] ************************************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.4 Ensure SSH access is limited | denygroups] ***********************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -171,3 +171,4 @@[0m
[0;36m[0m # Reject keys that are explicitly blacklisted
 RevokedKeys /etc/ssh/revoked_keys
 
[0;32m+DenyGroups games[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.5 Ensure SSH LogLevel is appropriate] ******************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.7 Ensure SSH MaxAuthTries is set to 4 or less] *********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.8 Ensure SSH IgnoreRhosts is enabled] ******************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.9 Ensure SSH HostbasedAuthentication is disabled] ******************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.11 Ensure SSH PermitEmptyPasswords is disabled] ********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.12 Ensure SSH PermitUserEnvironment is disabled] *******************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.13 Ensure only strong Ciphers are used] ****************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.14 Ensure only strong MAC algorithms are used] *********************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -60,7 +60,7 @@[0m
[0;36m[0m # eg Ruby's Net::SSH at around 2.2.* doesn't support sha2 for hmac, so this will have to be set true in this case.
 #
 
[0;31m-MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256[0m
[0;31m[0m[0;32m+MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256[0m
[0;32m[0m 
 # Alternative setting, if OpenSSH version is below v5.9
 #MACs hmac-ripemd160

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.15 Ensure only strong Key Exchange algorithms are used] ************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -70,7 +70,7 @@[0m
[0;36m[0m # eg ruby's Net::SSH at around 2.2.* doesn't support sha2 for kex, so this will have to be set true in this case.
 # based on: https://bettercrypto.org/static/applied-crypto-hardening.pdf
 
[0;31m-KexAlgorithms sntrup4591761x25519-sha512@tinyssh.org,curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256[0m
[0;31m[0m[0;32m+KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256[0m
[0;32m[0m 
 # Authentication
 # --------------

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.16 Ensure SSH Idle Timeout Interval is configured | clientalive] ***************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.16 Ensure SSH Idle Timeout Interval is configured | MaxAlive] ******************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.17 Ensure SSH LoginGraceTime is set to one minute or less] *********************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -77,7 +77,7 @@[0m
[0;36m[0m 
 # Secure Login directives.
 
[0;31m-LoginGraceTime 30s[0m
[0;31m[0m[0;32m+LoginGraceTime 30[0m
[0;32m[0m MaxAuthTries 2
 MaxSessions 10
 MaxStartups 10:30:100

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.18 Ensure SSH warning banner is configured] ************************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -164,7 +164,7 @@[0m
[0;36m[0m 
 PrintLastLog no
 
[0;31m-Banner /etc/ssh/banner.txt[0m
[0;31m[0m[0;32m+Banner /etc/ssh/banner[0m
[0;32m[0m 
 DebianBanner no
 

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.19 Ensure SSH PAM is enabled] **************************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.21 Ensure SSH MaxStartups is configured to 10:30:60] ***************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -80,7 +80,7 @@[0m
[0;36m[0m LoginGraceTime 30
 MaxAuthTries 2
 MaxSessions 10
[0;31m-MaxStartups 10:30:100[0m
[0;31m[0m[0;32m+MaxStartups 10:30:60[0m
[0;32m[0m 
 # Enable public key authentication
 PubkeyAuthentication yes

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.3.22 Ensure SSH MaxSessions is limited to 4] *************************************************************************************************************************************************************************
[0;31m--- before: /etc/ssh/sshd_config (content)[0m
[0;31m[0m[0;32m+++ after: /etc/ssh/sshd_config (content)[0m
[0;32m[0m[0;36m@@ -79,7 +79,7 @@[0m
[0;36m[0m 
 LoginGraceTime 30
 MaxAuthTries 2
[0;31m-MaxSessions 10[0m
[0;31m[0m[0;32m+MaxSessions 4[0m
[0;32m[0m MaxStartups 10:30:60
 
 # Enable public key authentication

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : restart_sshd] **********************************************************************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.4.3.2 Ensure password reuse is limited | update file according to CIS] ***********************************************************************************************************************************************
[0;31m--- before: /etc/pam.d/common-password (content)[0m
[0;31m[0m[0;32m+++ after: /etc/pam.d/common-password (content)[0m
[0;32m[0m[0;36m@@ -25,6 +25,7 @@[0m
[0;36m[0m password	[success=1 default=ignore]	pam_unix.so obscure sha512
 # here's the fallback if no module succeeds
 password	requisite			pam_deny.so
[0;32m+password       required                        pam_pwhistory.so remember=5[0m
[0;32m[0m # prime the stack with a positive return value if there isn't one already;
 # this avoids us returning an error just because nothing sets a success code
 # since the modules above will each just jump around

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.4.4 Ensure password hashing algorithm is SHA-512] ********************************************************************************************************************************************************************
[0;31m--- before: /etc/pam.d/common-password (content)[0m
[0;31m[0m[0;32m+++ after: /etc/pam.d/common-password (content)[0m
[0;32m[0m[0;36m@@ -22,7 +22,7 @@[0m
[0;36m[0m # pam-auth-update(8) for details.
 
 # here are the per-package modules (the "Primary" block)
[0;31m-password	[success=1 default=ignore]	pam_unix.so obscure sha512[0m
[0;31m[0m[0;32m+password       [success=1 default=ignore]      pam_unix.so obscure use_authtok try_first_pass sha512[0m
[0;32m[0m # here's the fallback if no module succeeds
 password	requisite			pam_deny.so
 password       required                        pam_pwhistory.so remember=5

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.5.1.1 Ensure minimum days between password changes is configured | PASS_MIN_DAYS] ************************************************************************************************************************************
[0;31m--- before: /etc/login.defs (content)[0m
[0;31m[0m[0;32m+++ after: /etc/login.defs (content)[0m
[0;32m[0m[0;36m@@ -158,7 +158,7 @@[0m
[0;36m[0m #	PASS_WARN_AGE	Number of days warning given before a password expires.
 #
 PASS_MAX_DAYS	99999
[0;31m-PASS_MIN_DAYS	0[0m
[0;31m[0m[0;32m+PASS_MIN_DAYS   7[0m
[0;32m[0m PASS_WARN_AGE	7
 
 #

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.5.1.1 Ensure minimum days between password changes is configured  | chage --mindays] *********************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17] => (item=root)[0m

TASK [cis_security : 5.5.1.3 Ensure password expiration warning days is 7 or more | PASS_WARN_AGE] ******************************************************************************************************************************************
[0;31m--- before: /etc/login.defs (content)[0m
[0;31m[0m[0;32m+++ after: /etc/login.defs (content)[0m
[0;32m[0m[0;36m@@ -159,7 +159,7 @@[0m
[0;36m[0m #
 PASS_MAX_DAYS	99999
 PASS_MIN_DAYS   7
[0;31m-PASS_WARN_AGE	7[0m
[0;31m[0m[0;32m+PASS_WARN_AGE  7[0m
[0;32m[0m 
 #
 # Min/max values for automatic uid selection in useradd

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.5.1.3 Ensure password expiration warning days is 7 or more  | chage --warndays] **************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17] => (item=root)[0m

TASK [cis_security : 5.5.1.5 Ensure all users last password change date is in the past | get list] ******************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.5.1.5 Ensure all users last password change date is in the past | save list] *****************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmpsn_xe588[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.5.2 Ensure system accounts are secured | set all system accounts to a non login shell] *******************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.5.3 Ensure default group for the root account is GID 0] **************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 5.5.4 Ensure default user umask is 027 or more restrictive - /etc/profile] *********************************************************************************************************************************************
[0;31m--- before: /etc/profile (content)[0m
[0;31m[0m[0;32m+++ after: /etc/profile (content)[0m
[0;32m[0m[0;36m@@ -25,3 +25,4 @@[0m
[0;36m[0m   done
   unset i
 fi
[0;32m+umask 027[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.5.4 Ensure default user umask is 027 or more restrictive - Fix for /etc/apt/apt.conf.d/50command-not-found] **********************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 5.5.5 Ensure default user shell timeout is 900 seconds or less | /etc/profile] *****************************************************************************************************************************************
[0;31m--- before: /etc/profile (content)[0m
[0;31m[0m[0;32m+++ after: /etc/profile (content)[0m
[0;32m[0m[0;36m@@ -26,3 +26,4 @@[0m
[0;36m[0m   unset i
 fi
 umask 027
[0;32m+readonly TMOUT=900 ; export TMOUT[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.7 Ensure access to the su command is restricted  | create su-group-access] *******************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmpaos3i_x5/su-group-access.j2[0m
[0;32m[0m[0;36m@@ -0,0 +1,2 @@[0m
[0;36m[0m[0;32m+# Managed by ansible alivx/CIS-Ubuntu-20.04-Ansible[0m
[0;32m[0m[0;32m+root[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 5.7 Ensure access to the su command is restricted  | create pam-d-su] **************************************************************************************************************************************************
[0;31m--- before: /etc/pam.d/su[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmp54mv9z6p/pam-d-su.j2[0m
[0;32m[0m[0;36m@@ -12,7 +12,7 @@[0m
[0;36m[0m # denying "root" user, unless she's a member of "foo" or explicitly
 # permitted earlier by e.g. "sufficient pam_rootok.so").
 # (Replaces the `SU_WHEEL_ONLY' option from login.defs)
[0;31m-# auth       required   pam_wheel.so[0m
[0;31m[0m[0;32m+auth           required        pam_wheel.so use_uid[0m
[0;32m[0m 
 # Uncomment this if you want wheel members to be able to
 # su without a password.
[0;36m@@ -20,7 +20,7 @@[0m
[0;36m[0m 
 # Uncomment this if you want members of a specific group to not
 # be allowed to use su at all.
[0;31m-# auth       required   pam_wheel.so deny group=nosu[0m
[0;31m[0m[0;32m+auth           required        pam_wheel.so use_uid deny group=nosu[0m
[0;32m[0m 
 # Uncomment and edit /etc/security/time.conf if you need to set
 # time restrainst on su usage.
[0;36m@@ -31,7 +31,7 @@[0m
[0;36m[0m # This module parses environment configuration file(s)
 # and also allows you to use an extended config
 # file /etc/security/pam_env.conf.
[0;31m-# [0m
[0;31m[0m[0;32m+#[0m
[0;32m[0m # parsing /etc/environment needs "readenv=1"
 session       required   pam_env.so readenv=1
 # locale variables are also kept into /etc/default/locale in etch
[0;36m@@ -40,7 +40,7 @@[0m
[0;36m[0m 
 # Defines the MAIL environment variable
 # However, userdel also needs MAIL_DIR and MAIL_FILE variables
[0;31m-# in /etc/login.defs to make sure that removing a user [0m
[0;31m[0m[0;32m+# in /etc/login.defs to make sure that removing a user[0m
[0;32m[0m # also removes the user's mail spool file.
 # See comments in /etc/login.defs
 #

[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 6.1.2 Ensure permissions on /etc/passwd are configured] ****************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.1.3 Ensure permissions on /etc/passwd- are configured] ***************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.1.4 Ensure permissions on /etc/group are configured] *****************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.1.5 Ensure permissions on /etc/group- are configured] ****************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.1.6 Ensure permissions on /etc/shadow are configured, with group 'shadow'] *******************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.1.7 Ensure permissions on /etc/shadow- are configured] ***************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.1.8 Ensure permissions on /etc/gshadow are configured] ***************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.1.9 Ensure permissions on /etc/gshadow- are configured] **************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.1.10 Ensure no world writable files exist | find files] **************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.1.10 Ensure no world writable files exist | save output] *************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmpnwducnei[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+["/root/git/loki-config.yaml", "/root/git/promtail-local-config.yaml", "/opt/McAfee/install-mfetp.sh", "/var/lib/docker/volumes/homer/custom.css.sample", "/var/lib/docker/volumes/homer/config.yml.dist", "/var/lib/docker/volumes/homer/additional-page.yml.dist", "/var/lib/docker/volumes/homer/tools/atlassian-confluence.png", "/var/lib/docker/volumes/homer/tools/dell_logo.png", "/var/lib/docker/volumes/homer/tools/carla_logo.png", "/var/lib/docker/volumes/homer/tools/jira.jpg", "/var/lib/docker/volumes/homer/tools/HCX_logo.png", "/var/lib/docker/volumes/homer/tools/quest.png", "/var/lib/docker/volumes/homer/tools/sample2.png", "/var/lib/docker/volumes/homer/tools/safe.jpg", "/var/lib/docker/volumes/homer/tools/bitbucket.png", "/var/lib/docker/volumes/homer/tools/infoblox.png", "/var/lib/docker/volumes/homer/tools/opsgenie.png", "/var/lib/docker/volumes/homer/tools/icinga_logo.png", "/var/lib/docker/volumes/homer/tools/snow.jpg", "/var/lib/docker/volumes/homer/tools/ansible-logo-red-t.png", "/var/lib/docker/volumes/homer/tools/logo2.png", "/var/lib/docker/volumes/homer/tools/sample.png", "/var/lib/docker/volumes/homer/tools/infoblox.jpg", "/var/lib/docker/volumes/homer/tools/immersive.jpg", "/var/lib/docker/volumes/homer/tools/icinga.png", "/var/lib/docker/volumes/homer/tools/GFK_logo.png", "/var/lib/docker/volumes/homer/tools/carla_l.png", "/var/lib/docker/volumes/homer/tools/HCX_logo.webp", "/var/lib/docker/volumes/homer/tools/jira.png", "/var/lib/docker/volumes/homer/tools/spotify.png", "/var/lib/docker/volumes/homer/tools/safe.png", "/var/lib/docker/volumes/homer/tools/Thumbs.db", "/var/lib/docker/volumes/homer/tools/vmware.png", "/var/lib/docker/volumes/homer/manifest.json", "/var/lib/docker/volumes/homer/config.yml", "/var/lib/docker/volumes/homer/config.yml.dist.sample-sui"][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 6.1.10 Ensure no world writable files exist | fix permission] **********************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/root/git/loki-config.yaml"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/root/git/loki-config.yaml)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/root/git/promtail-local-config.yaml"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/root/git/promtail-local-config.yaml)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/opt/McAfee/install-mfetp.sh"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/opt/McAfee/install-mfetp.sh)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/custom.css.sample"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/custom.css.sample)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/config.yml.dist"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/config.yml.dist)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/additional-page.yml.dist"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/additional-page.yml.dist)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/atlassian-confluence.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/atlassian-confluence.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/dell_logo.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/dell_logo.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/carla_logo.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/carla_logo.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/jira.jpg"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/jira.jpg)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/HCX_logo.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/HCX_logo.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/quest.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/quest.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/sample2.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/sample2.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/safe.jpg"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/safe.jpg)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/bitbucket.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/bitbucket.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/infoblox.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/infoblox.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/opsgenie.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/opsgenie.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/icinga_logo.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/icinga_logo.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/snow.jpg"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/snow.jpg)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/ansible-logo-red-t.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/ansible-logo-red-t.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/logo2.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/logo2.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/sample.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/sample.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/infoblox.jpg"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/infoblox.jpg)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/immersive.jpg"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/immersive.jpg)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/icinga.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/icinga.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/GFK_logo.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/GFK_logo.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/carla_l.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/carla_l.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/HCX_logo.webp"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/HCX_logo.webp)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/jira.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/jira.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/spotify.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/spotify.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/safe.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/safe.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/Thumbs.db"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/Thumbs.db)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/tools/vmware.png"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/tools/vmware.png)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/manifest.json"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/manifest.json)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/config.yml"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/config.yml)[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "0777",[0m
[0;31m[0m[0;32m+    "mode": "0775",[0m
[0;32m[0m     "path": "/var/lib/docker/volumes/homer/config.yml.dist.sample-sui"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/var/lib/docker/volumes/homer/config.yml.dist.sample-sui)[0m

TASK [cis_security : 6.2.1 Ensure accounts in /etc/passwd use shadowed passwords] ***********************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.2  Ensure password fields are not empty | list] ********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.2 Ensure password fields are not empty | Save output] **************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmpsls2ewzz[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.2 Ensure password fields are not empty | Lock account] *************************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.3 Ensure all groups in /etc/passwd exist in /etc/group | list] *****************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.3 Ensure all groups in /etc/passwd exist in /etc/group | save output] **********************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.4 Ensure all users' home directories exist | list] *****************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.4 Ensure all users' home directories exist | save] *****************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmp4jfalyse[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.4 Ensure all users' home directories exist | fix] ******************************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.5 Ensure users own their home directories | list] ******************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.5 Ensure users own their home directories | Var] *******************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.5 Ensure users own their home directories | save output] ***********************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmpf33_vrj0[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.5 Ensure users own their home directories | fix] *******************************************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.6 Ensure users home directories permissions are 750 or more restrictive - list] ************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.6 Ensure users' home directories permissions are 750 or more restrictive - print output] ***************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmp0yqo23_l[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+["/home/akupenov", "/home/akupenov", "/home/akupenov", "/home/akupenov"][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.6 Ensure users home directories permissions are 750 or more restrictive - fix] *************************************************************************************************************************************
[1;35m[WARNING]: conditional statements should not include jinja2 templating delimiters such as {{ }} or {% %}. Found: {{ output_6_2_6.stdout_lines|length > 0 }}[0m
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,4 +1,4 @@[0m
[0;36m[0m {
[0;31m-    "mode": "01777",[0m
[0;31m[0m[0;32m+    "mode": "01750",[0m
[0;32m[0m     "path": "/home/akupenov"
 }

[0;33mchanged: [dcex1039pkzoq17] => (item=/home/akupenov)[0m
[0;32mok: [dcex1039pkzoq17] => (item=/home/akupenov)[0m
[0;32mok: [dcex1039pkzoq17] => (item=/home/akupenov)[0m
[0;32mok: [dcex1039pkzoq17] => (item=/home/akupenov)[0m

TASK [cis_security : 6.2.7 Ensure users' dot files are not group or world writable | list] **************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.7 Ensure users' dot files and folders are not group or world writable | list] **************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.7 Ensure users' dot files are not group or world writable | save output] *******************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.7 Ensure users' dot files and folders are not group or world writable | save output] *******************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.7 Ensure users' dot files are not group or world writable | correct file permissions] ******************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.7 Ensure users' dot files and folders are not group or world writable | correct file permissions] ******************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.8 Ensure no users have .netrc files | list] ************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.8 Ensure no users have .netrc files | save output] *****************************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.9 Ensure no users have .forward files | list] **********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.9 Ensure no users have .forward files  | save output] **************************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.10 Ensure no users have .rhosts files | list] **********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.10 Ensure no users have .rhosts files | save output] ***************************************************************************************************************************************************************
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.11 Ensure root is the only UID 0 account| list] ********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.11 Ensure root is the only UID 0 account | Save output] ************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmpjubnqfyv[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.12 Ensure root PATH Integrity | run | Delete non-existing folders from PATH] ***************************************************************************************************************************************
[0;36mskipping: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.12 Ensure root PATH Integrity | run] *******************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.12 Ensure root PATH Integrity | run] *******************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.12 Ensure root PATH Integrity | save output] ***********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.13 Ensure no duplicate UIDs exist | list] **************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.13 Ensure no duplicate UIDs exist | save output] *******************************************************************************************************************************************************************
[0;31mfatal: [dcex1039pkzoq17]: FAILED! => {"changed": false, "checksum": "5a56bbcbbc5a7e9796eec8e56b21637f307beded", "msg": "Unsupported parameters for (ansible.legacy.copy) module: changed_when. Supported parameters include: _original_basename, attributes, backup, checksum, content, dest, directory_mode, follow, force, group, local_follow, mode, owner, remote_src, selevel, serole, setype, seuser, src, unsafe_writes, validate (attr)."}[0m
[0;36m...ignoring[0m

TASK [cis_security : 6.2.14 Ensure no duplicate GIDs exist | list] **************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.14 Ensure no duplicate GIDs exist | save output] *******************************************************************************************************************************************************************
[0;31mfatal: [dcex1039pkzoq17]: FAILED! => {"changed": false, "checksum": "7a67e558ecd37eb329936a08f6a1fafdf696174f", "msg": "Unsupported parameters for (ansible.legacy.copy) module: changed_when. Supported parameters include: _original_basename, attributes, backup, checksum, content, dest, directory_mode, follow, force, group, local_follow, mode, owner, remote_src, selevel, serole, setype, seuser, src, unsafe_writes, validate (attr)."}[0m
[0;36m...ignoring[0m

TASK [cis_security : 6.2.15 Ensure no duplicate user names exist | list] ********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.15 Ensure no duplicate user names exist | save output] *************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after: /root/.ansible/tmp/ansible-local-3223020xzapmmoa/tmpgcgc_71j[0m
[0;32m[0m[0;36m@@ -0,0 +1 @@[0m
[0;36m[0m[0;32m+[][0m
[0;32m\ No newline at end of file[0m
[0;32m[0m
[0;33mchanged: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.16 Ensure no duplicate group names exist | list] *******************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.16 Ensure no duplicate group names exist | save output] ************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.17 Ensure shadow group is empty | list] ****************************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : 6.2.17 Ensure shadow group is empty | save output] *********************************************************************************************************************************************************************
[0;32mok: [dcex1039pkzoq17][0m

TASK [cis_security : Add hardening file.] ***************************************************************************************************************************************************************************************************
[0;31m--- before[0m
[0;31m[0m[0;32m+++ after[0m
[0;32m[0m[0;36m@@ -1,7 +1,7 @@[0m
[0;36m[0m {
[0;31m-    "atime": 1685015772.8512273,[0m
[0;31m[0m[0;31m-    "mode": "0640",[0m
[0;31m[0m[0;31m-    "mtime": 1685015772.8512273,[0m
[0;31m[0m[0;32m+    "atime": 1685015772.855675,[0m
[0;32m[0m[0;32m+    "mode": "0400",[0m
[0;32m[0m[0;32m+    "mtime": 1685015772.855675,[0m
[0;32m[0m     "path": "/etc/.hardening",
[0;31m-    "state": "absent"[0m
[0;31m[0m[0;32m+    "state": "touch"[0m
[0;32m[0m }

[0;33mchanged: [dcex1039pkzoq17][0m

RUNNING HANDLER [cis_security : reloadTimesyncd] ********************************************************************************************************************************************************************************************
[0;31mfatal: [dcex1039pkzoq17]: FAILED! => {"changed": false, "msg": "Unable to start service systemd-timesyncd: Failed to start systemd-timesyncd.service: Unit systemd-timesyncd.service is masked.\n"}[0m

PLAY RECAP **********************************************************************************************************************************************************************************************************************************
[0;31mdcex1039pkzoq17[0m            : [0;32mok=222 [0m [0;33mchanged=83  [0m unreachable=0    [0;31mfailed=1   [0m [0;36mskipped=23  [0m rescued=0    [1;35mignored=3   [0m


Script done on 2023-05-25 13:56:13+02:00
